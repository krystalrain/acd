{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30593887019541954, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.701634462418095, "policy_loss": -0.0034052202237709875, "vf_loss": 9.709822104054112, "vf_explained_var": -0.00012676600487001482, "kl": 0.0009654472749295038, "entropy": 4.9757500110134005, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": -145.0, "episode_reward_min": -1006.2000000000003, "episode_reward_mean": -563.3600000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-873.600000000001, -446.3000000000001, -495.19999999999976, -254.79999999999993, -801.1000000000003, -945.2000000000012, -252.50000000000014, -439.59999999999906, -762.7999999999995, -835.2000000000007, -682.8999999999993, -437.49999999999983, -831.300000000001, -243.30000000000035, -239.2999999999997, -444.7000000000003, -980.400000000001, -646.4000000000004, -243.8000000000002, -675.8000000000012, -315.80000000000047, -835.3000000000009, -145.0, -1006.2000000000003, -679.5999999999995, -266.9999999999996, -180.59999999999997, -222.2000000000002, -302.1999999999995, -864.400000000001, -725.8999999999991, -231.10000000000025, -831.8999999999992, -844.6000000000004, -986.4000000000005, -373.80000000000007, -251.4000000000004, -661.1999999999994, -339.49999999999983, -938.5999999999989], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4742390105348386, "mean_inference_ms": 1.1692934645388178, "mean_action_processing_ms": 0.1052984458481718, "mean_env_wait_ms": 11.859192105824361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -145.0, "episode_reward_min": -1006.2000000000003, "episode_reward_mean": -563.3600000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-873.600000000001, -446.3000000000001, -495.19999999999976, -254.79999999999993, -801.1000000000003, -945.2000000000012, -252.50000000000014, -439.59999999999906, -762.7999999999995, -835.2000000000007, -682.8999999999993, -437.49999999999983, -831.300000000001, -243.30000000000035, -239.2999999999997, -444.7000000000003, -980.400000000001, -646.4000000000004, -243.8000000000002, -675.8000000000012, -315.80000000000047, -835.3000000000009, -145.0, -1006.2000000000003, -679.5999999999995, -266.9999999999996, -180.59999999999997, -222.2000000000002, -302.1999999999995, -864.400000000001, -725.8999999999991, -231.10000000000025, -831.8999999999992, -844.6000000000004, -986.4000000000005, -373.80000000000007, -251.4000000000004, -661.1999999999994, -339.49999999999983, -938.5999999999989], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4742390105348386, "mean_inference_ms": 1.1692934645388178, "mean_action_processing_ms": 0.1052984458481718, "mean_env_wait_ms": 11.859192105824361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 10453.914, "load_time_ms": 0.316, "load_throughput": 12652500.754, "learn_time_ms": 2432.153, "learn_throughput": 1644.633, "synch_weights_time_ms": 2.412}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-52-50", "timestamp": 1678549970, "time_this_iter_s": 10.460017919540405, "time_total_s": 10.460017919540405, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18530e80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18531030>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 10.460017919540405, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 47.96000000000001, "ram_util_percent": 16.086666666666662}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6883371701163631, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.218575768316946, "policy_loss": -0.01008483812573456, "vf_loss": 9.233213024754678, "vf_explained_var": 0.00025768952984963695, "kl": 0.004121519264758799, "entropy": 4.964514104781612, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": -132.8999999999999, "episode_reward_min": -1006.2000000000003, "episode_reward_mean": -535.0675000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-873.600000000001, -446.3000000000001, -495.19999999999976, -254.79999999999993, -801.1000000000003, -945.2000000000012, -252.50000000000014, -439.59999999999906, -762.7999999999995, -835.2000000000007, -682.8999999999993, -437.49999999999983, -831.300000000001, -243.30000000000035, -239.2999999999997, -444.7000000000003, -980.400000000001, -646.4000000000004, -243.8000000000002, -675.8000000000012, -315.80000000000047, -835.3000000000009, -145.0, -1006.2000000000003, -679.5999999999995, -266.9999999999996, -180.59999999999997, -222.2000000000002, -302.1999999999995, -864.400000000001, -725.8999999999991, -231.10000000000025, -831.8999999999992, -844.6000000000004, -986.4000000000005, -373.80000000000007, -251.4000000000004, -661.1999999999994, -339.49999999999983, -938.5999999999989, -964.5000000000011, -930.5000000000015, -899.000000000001, -662.6999999999992, -300.7000000000006, -955.8999999999987, -205.69999999999985, -310.6000000000003, -609.1999999999994, -455.0, -352.6999999999997, -238.80000000000035, -270.89999999999947, -885.100000000001, -132.8999999999999, -340.9000000000003, -294.8999999999997, -621.4999999999999, -860.9000000000012, -445.5999999999997, -295.2000000000003, -501.1999999999999, -304.9, -554.2000000000008, -539.7999999999996, -355.9999999999998, -296.1000000000005, -918.9999999999982, -230.59999999999974, -491.1999999999998, -751.8000000000002, -575.0000000000009, -713.3999999999996, -213.69999999999976, -430.2000000000004, -262.7000000000002, -214.2000000000004, -239.4999999999997, -736.3999999999991, -907.9000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.47952461593053, "mean_inference_ms": 1.1711123139403927, "mean_action_processing_ms": 0.10495185212624361, "mean_env_wait_ms": 11.764284011857228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -132.8999999999999, "episode_reward_min": -1006.2000000000003, "episode_reward_mean": -535.0675000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-873.600000000001, -446.3000000000001, -495.19999999999976, -254.79999999999993, -801.1000000000003, -945.2000000000012, -252.50000000000014, -439.59999999999906, -762.7999999999995, -835.2000000000007, -682.8999999999993, -437.49999999999983, -831.300000000001, -243.30000000000035, -239.2999999999997, -444.7000000000003, -980.400000000001, -646.4000000000004, -243.8000000000002, -675.8000000000012, -315.80000000000047, -835.3000000000009, -145.0, -1006.2000000000003, -679.5999999999995, -266.9999999999996, -180.59999999999997, -222.2000000000002, -302.1999999999995, -864.400000000001, -725.8999999999991, -231.10000000000025, -831.8999999999992, -844.6000000000004, -986.4000000000005, -373.80000000000007, -251.4000000000004, -661.1999999999994, -339.49999999999983, -938.5999999999989, -964.5000000000011, -930.5000000000015, -899.000000000001, -662.6999999999992, -300.7000000000006, -955.8999999999987, -205.69999999999985, -310.6000000000003, -609.1999999999994, -455.0, -352.6999999999997, -238.80000000000035, -270.89999999999947, -885.100000000001, -132.8999999999999, -340.9000000000003, -294.8999999999997, -621.4999999999999, -860.9000000000012, -445.5999999999997, -295.2000000000003, -501.1999999999999, -304.9, -554.2000000000008, -539.7999999999996, -355.9999999999998, -296.1000000000005, -918.9999999999982, -230.59999999999974, -491.1999999999998, -751.8000000000002, -575.0000000000009, -713.3999999999996, -213.69999999999976, -430.2000000000004, -262.7000000000002, -214.2000000000004, -239.4999999999997, -736.3999999999991, -907.9000000000004], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.47952461593053, "mean_inference_ms": 1.1711123139403927, "mean_action_processing_ms": 0.10495185212624361, "mean_env_wait_ms": 11.764284011857228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 10495.078, "load_time_ms": 2.786, "load_throughput": 1435852.283, "learn_time_ms": 2433.739, "learn_throughput": 1643.561, "synch_weights_time_ms": 2.138}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-53-01", "timestamp": 1678549981, "time_this_iter_s": 10.542136669158936, "time_total_s": 21.00215458869934, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18532170>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18532530>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 21.00215458869934, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 45.86000000000001, "ram_util_percent": 16.320000000000004}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6710288987044366, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 5.000000000000001e-05, "total_loss": 8.879308877452727, "policy_loss": -0.00644128893111502, "vf_loss": 8.890486343445316, "vf_explained_var": 0.0002819255475075014, "kl": 0.004192370015095124, "entropy": 4.945798875439552, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -126.60000000000008, "episode_reward_min": -1006.2000000000003, "episode_reward_mean": -484.449, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-315.80000000000047, -835.3000000000009, -145.0, -1006.2000000000003, -679.5999999999995, -266.9999999999996, -180.59999999999997, -222.2000000000002, -302.1999999999995, -864.400000000001, -725.8999999999991, -231.10000000000025, -831.8999999999992, -844.6000000000004, -986.4000000000005, -373.80000000000007, -251.4000000000004, -661.1999999999994, -339.49999999999983, -938.5999999999989, -964.5000000000011, -930.5000000000015, -899.000000000001, -662.6999999999992, -300.7000000000006, -955.8999999999987, -205.69999999999985, -310.6000000000003, -609.1999999999994, -455.0, -352.6999999999997, -238.80000000000035, -270.89999999999947, -885.100000000001, -132.8999999999999, -340.9000000000003, -294.8999999999997, -621.4999999999999, -860.9000000000012, -445.5999999999997, -295.2000000000003, -501.1999999999999, -304.9, -554.2000000000008, -539.7999999999996, -355.9999999999998, -296.1000000000005, -918.9999999999982, -230.59999999999974, -491.1999999999998, -751.8000000000002, -575.0000000000009, -713.3999999999996, -213.69999999999976, -430.2000000000004, -262.7000000000002, -214.2000000000004, -239.4999999999997, -736.3999999999991, -907.9000000000004, -303.00000000000017, -261.4999999999996, -259.4000000000003, -126.60000000000008, -295.4999999999995, -909.4999999999989, -352.5999999999996, -272.10000000000036, -368.29999999999967, -337.70000000000016, -359.80000000000035, -887.999999999999, -329.6999999999997, -892.500000000001, -230.00000000000026, -326.9999999999999, -288.3999999999996, -256.0000000000004, -452.1, -717.199999999999, -257.8000000000001, -659.1000000000008, -273.8000000000004, -310.30000000000035, -786.3000000000008, -243.8000000000001, -282.5999999999999, -782.6000000000001, -282.3000000000004, -243.20000000000041, -407.3, -261.60000000000014, -901.4000000000013, -309.29999999999984, -271.50000000000034, -265.2000000000002, -970.3999999999986, -335.5999999999999, -844.2999999999993, -255.89999999999995], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9583516910731555, "mean_inference_ms": 1.4334611466638558, "mean_action_processing_ms": 0.12488548870342515, "mean_env_wait_ms": 14.329704858543577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -126.60000000000008, "episode_reward_min": -1006.2000000000003, "episode_reward_mean": -484.449, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-315.80000000000047, -835.3000000000009, -145.0, -1006.2000000000003, -679.5999999999995, -266.9999999999996, -180.59999999999997, -222.2000000000002, -302.1999999999995, -864.400000000001, -725.8999999999991, -231.10000000000025, -831.8999999999992, -844.6000000000004, -986.4000000000005, -373.80000000000007, -251.4000000000004, -661.1999999999994, -339.49999999999983, -938.5999999999989, -964.5000000000011, -930.5000000000015, -899.000000000001, -662.6999999999992, -300.7000000000006, -955.8999999999987, -205.69999999999985, -310.6000000000003, -609.1999999999994, -455.0, -352.6999999999997, -238.80000000000035, -270.89999999999947, -885.100000000001, -132.8999999999999, -340.9000000000003, -294.8999999999997, -621.4999999999999, -860.9000000000012, -445.5999999999997, -295.2000000000003, -501.1999999999999, -304.9, -554.2000000000008, -539.7999999999996, -355.9999999999998, -296.1000000000005, -918.9999999999982, -230.59999999999974, -491.1999999999998, -751.8000000000002, -575.0000000000009, -713.3999999999996, -213.69999999999976, -430.2000000000004, -262.7000000000002, -214.2000000000004, -239.4999999999997, -736.3999999999991, -907.9000000000004, -303.00000000000017, -261.4999999999996, -259.4000000000003, -126.60000000000008, -295.4999999999995, -909.4999999999989, -352.5999999999996, -272.10000000000036, -368.29999999999967, -337.70000000000016, -359.80000000000035, -887.999999999999, -329.6999999999997, -892.500000000001, -230.00000000000026, -326.9999999999999, -288.3999999999996, -256.0000000000004, -452.1, -717.199999999999, -257.8000000000001, -659.1000000000008, -273.8000000000004, -310.30000000000035, -786.3000000000008, -243.8000000000001, -282.5999999999999, -782.6000000000001, -282.3000000000004, -243.20000000000041, -407.3, -261.60000000000014, -901.4000000000013, -309.29999999999984, -271.50000000000034, -265.2000000000002, -970.3999999999986, -335.5999999999999, -844.2999999999993, -255.89999999999995], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9583516910731555, "mean_inference_ms": 1.4334611466638558, "mean_action_processing_ms": 0.12488548870342515, "mean_env_wait_ms": 14.329704858543577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 15848.333, "load_time_ms": 7.27, "load_throughput": 550229.005, "learn_time_ms": 3270.383, "learn_throughput": 1223.098, "synch_weights_time_ms": 2.415}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-53-27", "timestamp": 1678550007, "time_this_iter_s": 26.578397512435913, "time_total_s": 47.580552101135254, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18532140>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18533e50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 47.580552101135254, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 97.46578947368421, "ram_util_percent": 22.06578947368421}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.786941095129136, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.480406568896386, "policy_loss": -0.009373328963955563, "vf_loss": 9.494585072609686, "vf_explained_var": 6.680757768692508e-05, "kl": 0.004816026626643287, "entropy": 4.925634748704971, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -126.60000000000008, "episode_reward_min": -993.9999999999987, "episode_reward_mean": -429.4239999999999, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-295.2000000000003, -501.1999999999999, -304.9, -554.2000000000008, -539.7999999999996, -355.9999999999998, -296.1000000000005, -918.9999999999982, -230.59999999999974, -491.1999999999998, -751.8000000000002, -575.0000000000009, -713.3999999999996, -213.69999999999976, -430.2000000000004, -262.7000000000002, -214.2000000000004, -239.4999999999997, -736.3999999999991, -907.9000000000004, -303.00000000000017, -261.4999999999996, -259.4000000000003, -126.60000000000008, -295.4999999999995, -909.4999999999989, -352.5999999999996, -272.10000000000036, -368.29999999999967, -337.70000000000016, -359.80000000000035, -887.999999999999, -329.6999999999997, -892.500000000001, -230.00000000000026, -326.9999999999999, -288.3999999999996, -256.0000000000004, -452.1, -717.199999999999, -257.8000000000001, -659.1000000000008, -273.8000000000004, -310.30000000000035, -786.3000000000008, -243.8000000000001, -282.5999999999999, -782.6000000000001, -282.3000000000004, -243.20000000000041, -407.3, -261.60000000000014, -901.4000000000013, -309.29999999999984, -271.50000000000034, -265.2000000000002, -970.3999999999986, -335.5999999999999, -844.2999999999993, -255.89999999999995, -460.8, -993.9999999999987, -320.7000000000005, -200.2999999999997, -911.3999999999992, -274.10000000000025, -216.0999999999997, -290.9000000000002, -269.0000000000002, -244.6000000000003, -550.3999999999996, -378.599999999999, -225.79999999999959, -490.39999999999975, -318.3000000000002, -693.2999999999997, -260.7000000000005, -273.7000000000004, -557.0999999999997, -259.3000000000003, -202.60000000000028, -238.2000000000003, -511.99999999999943, -250.39999999999978, -268.7, -417.7000000000005, -939.6000000000007, -317.5000000000002, -709.0999999999998, -270.90000000000026, -270.10000000000014, -188.70000000000013, -288.90000000000003, -600.0999999999996, -604.2999999999996, -364.49999999999994, -213.20000000000033, -250.4999999999996, -869.6999999999985, -272.0000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.532722272340678, "mean_inference_ms": 1.7539488070533, "mean_action_processing_ms": 0.1481123335632518, "mean_env_wait_ms": 17.436056860536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -126.60000000000008, "episode_reward_min": -993.9999999999987, "episode_reward_mean": -429.4239999999999, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-295.2000000000003, -501.1999999999999, -304.9, -554.2000000000008, -539.7999999999996, -355.9999999999998, -296.1000000000005, -918.9999999999982, -230.59999999999974, -491.1999999999998, -751.8000000000002, -575.0000000000009, -713.3999999999996, -213.69999999999976, -430.2000000000004, -262.7000000000002, -214.2000000000004, -239.4999999999997, -736.3999999999991, -907.9000000000004, -303.00000000000017, -261.4999999999996, -259.4000000000003, -126.60000000000008, -295.4999999999995, -909.4999999999989, -352.5999999999996, -272.10000000000036, -368.29999999999967, -337.70000000000016, -359.80000000000035, -887.999999999999, -329.6999999999997, -892.500000000001, -230.00000000000026, -326.9999999999999, -288.3999999999996, -256.0000000000004, -452.1, -717.199999999999, -257.8000000000001, -659.1000000000008, -273.8000000000004, -310.30000000000035, -786.3000000000008, -243.8000000000001, -282.5999999999999, -782.6000000000001, -282.3000000000004, -243.20000000000041, -407.3, -261.60000000000014, -901.4000000000013, -309.29999999999984, -271.50000000000034, -265.2000000000002, -970.3999999999986, -335.5999999999999, -844.2999999999993, -255.89999999999995, -460.8, -993.9999999999987, -320.7000000000005, -200.2999999999997, -911.3999999999992, -274.10000000000025, -216.0999999999997, -290.9000000000002, -269.0000000000002, -244.6000000000003, -550.3999999999996, -378.599999999999, -225.79999999999959, -490.39999999999975, -318.3000000000002, -693.2999999999997, -260.7000000000005, -273.7000000000004, -557.0999999999997, -259.3000000000003, -202.60000000000028, -238.2000000000003, -511.99999999999943, -250.39999999999978, -268.7, -417.7000000000005, -939.6000000000007, -317.5000000000002, -709.0999999999998, -270.90000000000026, -270.10000000000014, -188.70000000000013, -288.90000000000003, -600.0999999999996, -604.2999999999996, -364.49999999999994, -213.20000000000033, -250.4999999999996, -869.6999999999985, -272.0000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.532722272340678, "mean_inference_ms": 1.7539488070533, "mean_action_processing_ms": 0.1481123335632518, "mean_env_wait_ms": 17.436056860536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 16608.967, "load_time_ms": 7.114, "load_throughput": 562257.985, "learn_time_ms": 3104.509, "learn_throughput": 1288.449, "synch_weights_time_ms": 2.285}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-53-46", "timestamp": 1678550026, "time_this_iter_s": 18.89661693572998, "time_total_s": 66.47716903686523, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183ac2b0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183acf10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 66.47716903686523, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 81.64814814814814, "ram_util_percent": 19.825925925925926}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9204907241367525, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.736815649463285, "policy_loss": -0.008443009450791343, "vf_loss": 9.750106362373598, "vf_explained_var": 4.672254285504741e-05, "kl": 0.004334256971728374, "entropy": 4.9018892272826164, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -154.99999999999991, "episode_reward_min": -993.9999999999987, "episode_reward_mean": -374.48400000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-257.8000000000001, -659.1000000000008, -273.8000000000004, -310.30000000000035, -786.3000000000008, -243.8000000000001, -282.5999999999999, -782.6000000000001, -282.3000000000004, -243.20000000000041, -407.3, -261.60000000000014, -901.4000000000013, -309.29999999999984, -271.50000000000034, -265.2000000000002, -970.3999999999986, -335.5999999999999, -844.2999999999993, -255.89999999999995, -460.8, -993.9999999999987, -320.7000000000005, -200.2999999999997, -911.3999999999992, -274.10000000000025, -216.0999999999997, -290.9000000000002, -269.0000000000002, -244.6000000000003, -550.3999999999996, -378.599999999999, -225.79999999999959, -490.39999999999975, -318.3000000000002, -693.2999999999997, -260.7000000000005, -273.7000000000004, -557.0999999999997, -259.3000000000003, -202.60000000000028, -238.2000000000003, -511.99999999999943, -250.39999999999978, -268.7, -417.7000000000005, -939.6000000000007, -317.5000000000002, -709.0999999999998, -270.90000000000026, -270.10000000000014, -188.70000000000013, -288.90000000000003, -600.0999999999996, -604.2999999999996, -364.49999999999994, -213.20000000000033, -250.4999999999996, -869.6999999999985, -272.0000000000002, -703.3999999999993, -249.2000000000001, -297.49999999999994, -279.89999999999986, -217.89999999999966, -229.2000000000003, -271.8000000000001, -236.80000000000027, -206.99999999999986, -270.19999999999976, -225.40000000000032, -234.90000000000003, -324.0, -280.3999999999998, -588.2000000000003, -244.49999999999983, -154.99999999999991, -708.1000000000007, -583.999999999999, -250.4000000000003, -186.8999999999997, -250.39999999999966, -261.30000000000024, -209.20000000000013, -422.1999999999993, -270.50000000000017, -513.1999999999994, -202.20000000000033, -240.60000000000028, -230.20000000000002, -425.1000000000001, -185.7000000000001, -278.49999999999983, -294.80000000000007, -248.0, -318.89999999999986, -291.3, -299.60000000000036, -408.1000000000001, -171.39999999999975], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7529946891037587, "mean_inference_ms": 1.8767882850139939, "mean_action_processing_ms": 0.1578422600764984, "mean_env_wait_ms": 18.62109704034301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -154.99999999999991, "episode_reward_min": -993.9999999999987, "episode_reward_mean": -374.48400000000004, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-257.8000000000001, -659.1000000000008, -273.8000000000004, -310.30000000000035, -786.3000000000008, -243.8000000000001, -282.5999999999999, -782.6000000000001, -282.3000000000004, -243.20000000000041, -407.3, -261.60000000000014, -901.4000000000013, -309.29999999999984, -271.50000000000034, -265.2000000000002, -970.3999999999986, -335.5999999999999, -844.2999999999993, -255.89999999999995, -460.8, -993.9999999999987, -320.7000000000005, -200.2999999999997, -911.3999999999992, -274.10000000000025, -216.0999999999997, -290.9000000000002, -269.0000000000002, -244.6000000000003, -550.3999999999996, -378.599999999999, -225.79999999999959, -490.39999999999975, -318.3000000000002, -693.2999999999997, -260.7000000000005, -273.7000000000004, -557.0999999999997, -259.3000000000003, -202.60000000000028, -238.2000000000003, -511.99999999999943, -250.39999999999978, -268.7, -417.7000000000005, -939.6000000000007, -317.5000000000002, -709.0999999999998, -270.90000000000026, -270.10000000000014, -188.70000000000013, -288.90000000000003, -600.0999999999996, -604.2999999999996, -364.49999999999994, -213.20000000000033, -250.4999999999996, -869.6999999999985, -272.0000000000002, -703.3999999999993, -249.2000000000001, -297.49999999999994, -279.89999999999986, -217.89999999999966, -229.2000000000003, -271.8000000000001, -236.80000000000027, -206.99999999999986, -270.19999999999976, -225.40000000000032, -234.90000000000003, -324.0, -280.3999999999998, -588.2000000000003, -244.49999999999983, -154.99999999999991, -708.1000000000007, -583.999999999999, -250.4000000000003, -186.8999999999997, -250.39999999999966, -261.30000000000024, -209.20000000000013, -422.1999999999993, -270.50000000000017, -513.1999999999994, -202.20000000000033, -240.60000000000028, -230.20000000000002, -425.1000000000001, -185.7000000000001, -278.49999999999983, -294.80000000000007, -248.0, -318.89999999999986, -291.3, -299.60000000000036, -408.1000000000001, -171.39999999999975], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7529946891037587, "mean_inference_ms": 1.8767882850139939, "mean_action_processing_ms": 0.1578422600764984, "mean_env_wait_ms": 18.62109704034301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 15368.302, "load_time_ms": 6.956, "load_throughput": 575015.115, "learn_time_ms": 2983.91, "learn_throughput": 1340.523, "synch_weights_time_ms": 2.252}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-53-57", "timestamp": 1678550037, "time_this_iter_s": 10.411475419998169, "time_total_s": 76.8886444568634, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a185339a0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18531750>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 76.8886444568634, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 46.84666666666668, "ram_util_percent": 16.400000000000002}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7347236420839064, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 5.000000000000001e-05, "total_loss": 9.78507751341789, "policy_loss": -0.006904801980952823, "vf_loss": 9.796831533985753, "vf_explained_var": 5.0964470832578595e-05, "kl": 0.004024030668763953, "entropy": 4.874352207491475, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -154.99999999999991, "episode_reward_min": -939.6000000000007, "episode_reward_mean": -319.163, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-202.60000000000028, -238.2000000000003, -511.99999999999943, -250.39999999999978, -268.7, -417.7000000000005, -939.6000000000007, -317.5000000000002, -709.0999999999998, -270.90000000000026, -270.10000000000014, -188.70000000000013, -288.90000000000003, -600.0999999999996, -604.2999999999996, -364.49999999999994, -213.20000000000033, -250.4999999999996, -869.6999999999985, -272.0000000000002, -703.3999999999993, -249.2000000000001, -297.49999999999994, -279.89999999999986, -217.89999999999966, -229.2000000000003, -271.8000000000001, -236.80000000000027, -206.99999999999986, -270.19999999999976, -225.40000000000032, -234.90000000000003, -324.0, -280.3999999999998, -588.2000000000003, -244.49999999999983, -154.99999999999991, -708.1000000000007, -583.999999999999, -250.4000000000003, -186.8999999999997, -250.39999999999966, -261.30000000000024, -209.20000000000013, -422.1999999999993, -270.50000000000017, -513.1999999999994, -202.20000000000033, -240.60000000000028, -230.20000000000002, -425.1000000000001, -185.7000000000001, -278.49999999999983, -294.80000000000007, -248.0, -318.89999999999986, -291.3, -299.60000000000036, -408.1000000000001, -171.39999999999975, -319.8999999999997, -297.2999999999998, -177.89999999999984, -229.5000000000004, -243.50000000000043, -199.50000000000028, -242.39999999999964, -290.80000000000007, -217.3, -200.3000000000002, -280.69999999999953, -329.2, -290.7999999999998, -288.60000000000053, -277.9000000000001, -212.89999999999966, -888.8999999999985, -219.20000000000044, -289.50000000000006, -259.50000000000006, -219.29999999999998, -236.49999999999977, -547.0999999999999, -264.0000000000002, -255.70000000000036, -387.4000000000005, -250.70000000000036, -240.50000000000043, -238.9000000000004, -208.49999999999977, -286.3, -299.00000000000017, -168.79999999999967, -239.20000000000022, -517.0999999999998, -482.20000000000056, -224.20000000000002, -287.5000000000003, -258.2000000000004, -235.00000000000034], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.806981588585896, "mean_inference_ms": 1.86344298332927, "mean_action_processing_ms": 0.1558524155492337, "mean_env_wait_ms": 18.481419406415153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -154.99999999999991, "episode_reward_min": -939.6000000000007, "episode_reward_mean": -319.163, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-202.60000000000028, -238.2000000000003, -511.99999999999943, -250.39999999999978, -268.7, -417.7000000000005, -939.6000000000007, -317.5000000000002, -709.0999999999998, -270.90000000000026, -270.10000000000014, -188.70000000000013, -288.90000000000003, -600.0999999999996, -604.2999999999996, -364.49999999999994, -213.20000000000033, -250.4999999999996, -869.6999999999985, -272.0000000000002, -703.3999999999993, -249.2000000000001, -297.49999999999994, -279.89999999999986, -217.89999999999966, -229.2000000000003, -271.8000000000001, -236.80000000000027, -206.99999999999986, -270.19999999999976, -225.40000000000032, -234.90000000000003, -324.0, -280.3999999999998, -588.2000000000003, -244.49999999999983, -154.99999999999991, -708.1000000000007, -583.999999999999, -250.4000000000003, -186.8999999999997, -250.39999999999966, -261.30000000000024, -209.20000000000013, -422.1999999999993, -270.50000000000017, -513.1999999999994, -202.20000000000033, -240.60000000000028, -230.20000000000002, -425.1000000000001, -185.7000000000001, -278.49999999999983, -294.80000000000007, -248.0, -318.89999999999986, -291.3, -299.60000000000036, -408.1000000000001, -171.39999999999975, -319.8999999999997, -297.2999999999998, -177.89999999999984, -229.5000000000004, -243.50000000000043, -199.50000000000028, -242.39999999999964, -290.80000000000007, -217.3, -200.3000000000002, -280.69999999999953, -329.2, -290.7999999999998, -288.60000000000053, -277.9000000000001, -212.89999999999966, -888.8999999999985, -219.20000000000044, -289.50000000000006, -259.50000000000006, -219.29999999999998, -236.49999999999977, -547.0999999999999, -264.0000000000002, -255.70000000000036, -387.4000000000005, -250.70000000000036, -240.50000000000043, -238.9000000000004, -208.49999999999977, -286.3, -299.00000000000017, -168.79999999999967, -239.20000000000022, -517.0999999999998, -482.20000000000056, -224.20000000000002, -287.5000000000003, -258.2000000000004, -235.00000000000034], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.806981588585896, "mean_inference_ms": 1.86344298332927, "mean_action_processing_ms": 0.1558524155492337, "mean_env_wait_ms": 18.481419406415153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16159.717, "load_time_ms": 7.299, "load_throughput": 548051.156, "learn_time_ms": 3248.778, "learn_throughput": 1231.232, "synch_weights_time_ms": 2.344}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-54-17", "timestamp": 1678550057, "time_this_iter_s": 20.13330340385437, "time_total_s": 97.02194786071777, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c5900>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c63e0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 97.02194786071777, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 88.88620689655173, "ram_util_percent": 19.599999999999998}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6647434552831034, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 5.000000000000001e-05, "total_loss": 9.817465729867259, "policy_loss": -0.014727112541215554, "vf_loss": 9.837032976458149, "vf_explained_var": 4.852952495698006e-05, "kl": 0.003436023038570739, "entropy": 4.8509108620305215, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -168.79999999999967, "episode_reward_min": -931.6999999999988, "episode_reward_mean": -285.641, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.8999999999997, -250.39999999999966, -261.30000000000024, -209.20000000000013, -422.1999999999993, -270.50000000000017, -513.1999999999994, -202.20000000000033, -240.60000000000028, -230.20000000000002, -425.1000000000001, -185.7000000000001, -278.49999999999983, -294.80000000000007, -248.0, -318.89999999999986, -291.3, -299.60000000000036, -408.1000000000001, -171.39999999999975, -319.8999999999997, -297.2999999999998, -177.89999999999984, -229.5000000000004, -243.50000000000043, -199.50000000000028, -242.39999999999964, -290.80000000000007, -217.3, -200.3000000000002, -280.69999999999953, -329.2, -290.7999999999998, -288.60000000000053, -277.9000000000001, -212.89999999999966, -888.8999999999985, -219.20000000000044, -289.50000000000006, -259.50000000000006, -219.29999999999998, -236.49999999999977, -547.0999999999999, -264.0000000000002, -255.70000000000036, -387.4000000000005, -250.70000000000036, -240.50000000000043, -238.9000000000004, -208.49999999999977, -286.3, -299.00000000000017, -168.79999999999967, -239.20000000000022, -517.0999999999998, -482.20000000000056, -224.20000000000002, -287.5000000000003, -258.2000000000004, -235.00000000000034, -256.3999999999998, -274.8999999999999, -306.7, -254.7000000000001, -227.99999999999994, -258.79999999999967, -285.30000000000007, -218.9, -208.49999999999977, -278.0000000000003, -259.30000000000035, -259.8, -613.4999999999991, -249.89999999999986, -225.80000000000007, -230.19999999999973, -228.69999999999973, -287.29999999999995, -238.09999999999965, -238.8000000000003, -256.0999999999999, -229.00000000000028, -222.9000000000005, -248.39999999999966, -378.1000000000006, -931.6999999999988, -281.2, -185.29999999999993, -301.3000000000003, -179.50000000000014, -222.7000000000004, -265.4000000000005, -248.50000000000028, -242.3000000000003, -264.40000000000026, -272.70000000000033, -200.70000000000007, -254.30000000000035, -414.3000000000002, -253.9000000000005], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9904830236289928, "mean_inference_ms": 1.9531983834248345, "mean_action_processing_ms": 0.16599982327520046, "mean_env_wait_ms": 19.209804936658347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -168.79999999999967, "episode_reward_min": -931.6999999999988, "episode_reward_mean": -285.641, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-186.8999999999997, -250.39999999999966, -261.30000000000024, -209.20000000000013, -422.1999999999993, -270.50000000000017, -513.1999999999994, -202.20000000000033, -240.60000000000028, -230.20000000000002, -425.1000000000001, -185.7000000000001, -278.49999999999983, -294.80000000000007, -248.0, -318.89999999999986, -291.3, -299.60000000000036, -408.1000000000001, -171.39999999999975, -319.8999999999997, -297.2999999999998, -177.89999999999984, -229.5000000000004, -243.50000000000043, -199.50000000000028, -242.39999999999964, -290.80000000000007, -217.3, -200.3000000000002, -280.69999999999953, -329.2, -290.7999999999998, -288.60000000000053, -277.9000000000001, -212.89999999999966, -888.8999999999985, -219.20000000000044, -289.50000000000006, -259.50000000000006, -219.29999999999998, -236.49999999999977, -547.0999999999999, -264.0000000000002, -255.70000000000036, -387.4000000000005, -250.70000000000036, -240.50000000000043, -238.9000000000004, -208.49999999999977, -286.3, -299.00000000000017, -168.79999999999967, -239.20000000000022, -517.0999999999998, -482.20000000000056, -224.20000000000002, -287.5000000000003, -258.2000000000004, -235.00000000000034, -256.3999999999998, -274.8999999999999, -306.7, -254.7000000000001, -227.99999999999994, -258.79999999999967, -285.30000000000007, -218.9, -208.49999999999977, -278.0000000000003, -259.30000000000035, -259.8, -613.4999999999991, -249.89999999999986, -225.80000000000007, -230.19999999999973, -228.69999999999973, -287.29999999999995, -238.09999999999965, -238.8000000000003, -256.0999999999999, -229.00000000000028, -222.9000000000005, -248.39999999999966, -378.1000000000006, -931.6999999999988, -281.2, -185.29999999999993, -301.3000000000003, -179.50000000000014, -222.7000000000004, -265.4000000000005, -248.50000000000028, -242.3000000000003, -264.40000000000026, -272.70000000000033, -200.70000000000007, -254.30000000000035, -414.3000000000002, -253.9000000000005], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9904830236289928, "mean_inference_ms": 1.9531983834248345, "mean_action_processing_ms": 0.16599982327520046, "mean_env_wait_ms": 19.209804936658347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 17435.662, "load_time_ms": 8.166, "load_throughput": 489806.906, "learn_time_ms": 3184.59, "learn_throughput": 1256.048, "synch_weights_time_ms": 2.303}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-54-42", "timestamp": 1678550082, "time_this_iter_s": 25.099125623703003, "time_total_s": 122.12107348442078, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183af2e0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183aed10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 122.12107348442078, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 94.61714285714287, "ram_util_percent": 22.828571428571426}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6837560967091592, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.80862204643988, "policy_loss": -0.011204566896682786, "vf_loss": 9.824639188089678, "vf_explained_var": 2.7868055528210056e-05, "kl": 0.004801214984587014, "entropy": 4.8200383340158774, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -168.79999999999967, "episode_reward_min": -931.6999999999988, "episode_reward_mean": -292.8900000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-219.29999999999998, -236.49999999999977, -547.0999999999999, -264.0000000000002, -255.70000000000036, -387.4000000000005, -250.70000000000036, -240.50000000000043, -238.9000000000004, -208.49999999999977, -286.3, -299.00000000000017, -168.79999999999967, -239.20000000000022, -517.0999999999998, -482.20000000000056, -224.20000000000002, -287.5000000000003, -258.2000000000004, -235.00000000000034, -256.3999999999998, -274.8999999999999, -306.7, -254.7000000000001, -227.99999999999994, -258.79999999999967, -285.30000000000007, -218.9, -208.49999999999977, -278.0000000000003, -259.30000000000035, -259.8, -613.4999999999991, -249.89999999999986, -225.80000000000007, -230.19999999999973, -228.69999999999973, -287.29999999999995, -238.09999999999965, -238.8000000000003, -256.0999999999999, -229.00000000000028, -222.9000000000005, -248.39999999999966, -378.1000000000006, -931.6999999999988, -281.2, -185.29999999999993, -301.3000000000003, -179.50000000000014, -222.7000000000004, -265.4000000000005, -248.50000000000028, -242.3000000000003, -264.40000000000026, -272.70000000000033, -200.70000000000007, -254.30000000000035, -414.3000000000002, -253.9000000000005, -280.19999999999953, -353.99999999999994, -229.5000000000003, -250.8000000000004, -267.9000000000003, -307.49999999999994, -225.60000000000022, -600.5999999999991, -184.5, -189.00000000000009, -240.60000000000028, -407.10000000000105, -259.0, -239.70000000000027, -476.40000000000015, -211.4999999999999, -263.6999999999998, -217.6999999999998, -313.70000000000005, -560.0, -256.1, -237.20000000000044, -224.90000000000015, -557.7999999999993, -246.09999999999954, -200.8000000000003, -336.5000000000001, -280.30000000000007, -252.8000000000001, -238.59999999999988, -243.40000000000012, -237.19999999999985, -201.70000000000005, -568.300000000001, -244.89999999999995, -239.80000000000038, -207.4999999999998, -886.4000000000003, -255.39999999999998, -193.89999999999978], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.117848984487894, "mean_inference_ms": 2.0155986988448586, "mean_action_processing_ms": 0.1739264897798141, "mean_env_wait_ms": 19.675683898024364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -168.79999999999967, "episode_reward_min": -931.6999999999988, "episode_reward_mean": -292.8900000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-219.29999999999998, -236.49999999999977, -547.0999999999999, -264.0000000000002, -255.70000000000036, -387.4000000000005, -250.70000000000036, -240.50000000000043, -238.9000000000004, -208.49999999999977, -286.3, -299.00000000000017, -168.79999999999967, -239.20000000000022, -517.0999999999998, -482.20000000000056, -224.20000000000002, -287.5000000000003, -258.2000000000004, -235.00000000000034, -256.3999999999998, -274.8999999999999, -306.7, -254.7000000000001, -227.99999999999994, -258.79999999999967, -285.30000000000007, -218.9, -208.49999999999977, -278.0000000000003, -259.30000000000035, -259.8, -613.4999999999991, -249.89999999999986, -225.80000000000007, -230.19999999999973, -228.69999999999973, -287.29999999999995, -238.09999999999965, -238.8000000000003, -256.0999999999999, -229.00000000000028, -222.9000000000005, -248.39999999999966, -378.1000000000006, -931.6999999999988, -281.2, -185.29999999999993, -301.3000000000003, -179.50000000000014, -222.7000000000004, -265.4000000000005, -248.50000000000028, -242.3000000000003, -264.40000000000026, -272.70000000000033, -200.70000000000007, -254.30000000000035, -414.3000000000002, -253.9000000000005, -280.19999999999953, -353.99999999999994, -229.5000000000003, -250.8000000000004, -267.9000000000003, -307.49999999999994, -225.60000000000022, -600.5999999999991, -184.5, -189.00000000000009, -240.60000000000028, -407.10000000000105, -259.0, -239.70000000000027, -476.40000000000015, -211.4999999999999, -263.6999999999998, -217.6999999999998, -313.70000000000005, -560.0, -256.1, -237.20000000000044, -224.90000000000015, -557.7999999999993, -246.09999999999954, -200.8000000000003, -336.5000000000001, -280.30000000000007, -252.8000000000001, -238.59999999999988, -243.40000000000012, -237.19999999999985, -201.70000000000005, -568.300000000001, -244.89999999999995, -239.80000000000038, -207.4999999999998, -886.4000000000003, -255.39999999999998, -193.89999999999978], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.117848984487894, "mean_inference_ms": 2.0155986988448586, "mean_action_processing_ms": 0.1739264897798141, "mean_env_wait_ms": 19.675683898024364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16584.929, "load_time_ms": 7.99, "load_throughput": 500640.556, "learn_time_ms": 3098.33, "learn_throughput": 1291.018, "synch_weights_time_ms": 2.245}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-54-53", "timestamp": 1678550093, "time_this_iter_s": 10.635740518569946, "time_total_s": 132.75681400299072, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c6b00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c67d0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 132.75681400299072, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 44.65625, "ram_util_percent": 16.4}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5995825131093302, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 9.819476598308933, "policy_loss": -0.009279993227532795, "vf_loss": 9.833572396924419, "vf_explained_var": 9.745167147728705e-06, "kl": 0.0035680977405475652, "entropy": 4.818555156646236, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -176.89999999999998, "episode_reward_min": -931.6999999999988, "episode_reward_mean": -286.1700000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.0999999999999, -229.00000000000028, -222.9000000000005, -248.39999999999966, -378.1000000000006, -931.6999999999988, -281.2, -185.29999999999993, -301.3000000000003, -179.50000000000014, -222.7000000000004, -265.4000000000005, -248.50000000000028, -242.3000000000003, -264.40000000000026, -272.70000000000033, -200.70000000000007, -254.30000000000035, -414.3000000000002, -253.9000000000005, -280.19999999999953, -353.99999999999994, -229.5000000000003, -250.8000000000004, -267.9000000000003, -307.49999999999994, -225.60000000000022, -600.5999999999991, -184.5, -189.00000000000009, -240.60000000000028, -407.10000000000105, -259.0, -239.70000000000027, -476.40000000000015, -211.4999999999999, -263.6999999999998, -217.6999999999998, -313.70000000000005, -560.0, -256.1, -237.20000000000044, -224.90000000000015, -557.7999999999993, -246.09999999999954, -200.8000000000003, -336.5000000000001, -280.30000000000007, -252.8000000000001, -238.59999999999988, -243.40000000000012, -237.19999999999985, -201.70000000000005, -568.300000000001, -244.89999999999995, -239.80000000000038, -207.4999999999998, -886.4000000000003, -255.39999999999998, -193.89999999999978, -291.8, -273.49999999999994, -303.10000000000025, -890.2000000000012, -270.20000000000005, -223.30000000000013, -304.9, -255.30000000000004, -247.60000000000025, -246.50000000000037, -282.8000000000005, -253.40000000000035, -239.20000000000013, -199.60000000000016, -265.0999999999996, -176.89999999999998, -289.00000000000017, -233.19999999999965, -261.8000000000002, -280.60000000000014, -191.1999999999997, -216.89999999999958, -215.79999999999995, -185.69999999999973, -273.30000000000047, -226.80000000000035, -250.6000000000002, -196.9000000000003, -252.99999999999977, -232.40000000000003, -248.09999999999997, -274.29999999999984, -198.69999999999985, -233.70000000000044, -236.8000000000002, -285.69999999999993, -273.00000000000006, -296.60000000000025, -238.19999999999962, -259.9999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.042559308970006, "mean_inference_ms": 1.9815754821908758, "mean_action_processing_ms": 0.17151927060007488, "mean_env_wait_ms": 19.325577489682104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -176.89999999999998, "episode_reward_min": -931.6999999999988, "episode_reward_mean": -286.1700000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-256.0999999999999, -229.00000000000028, -222.9000000000005, -248.39999999999966, -378.1000000000006, -931.6999999999988, -281.2, -185.29999999999993, -301.3000000000003, -179.50000000000014, -222.7000000000004, -265.4000000000005, -248.50000000000028, -242.3000000000003, -264.40000000000026, -272.70000000000033, -200.70000000000007, -254.30000000000035, -414.3000000000002, -253.9000000000005, -280.19999999999953, -353.99999999999994, -229.5000000000003, -250.8000000000004, -267.9000000000003, -307.49999999999994, -225.60000000000022, -600.5999999999991, -184.5, -189.00000000000009, -240.60000000000028, -407.10000000000105, -259.0, -239.70000000000027, -476.40000000000015, -211.4999999999999, -263.6999999999998, -217.6999999999998, -313.70000000000005, -560.0, -256.1, -237.20000000000044, -224.90000000000015, -557.7999999999993, -246.09999999999954, -200.8000000000003, -336.5000000000001, -280.30000000000007, -252.8000000000001, -238.59999999999988, -243.40000000000012, -237.19999999999985, -201.70000000000005, -568.300000000001, -244.89999999999995, -239.80000000000038, -207.4999999999998, -886.4000000000003, -255.39999999999998, -193.89999999999978, -291.8, -273.49999999999994, -303.10000000000025, -890.2000000000012, -270.20000000000005, -223.30000000000013, -304.9, -255.30000000000004, -247.60000000000025, -246.50000000000037, -282.8000000000005, -253.40000000000035, -239.20000000000013, -199.60000000000016, -265.0999999999996, -176.89999999999998, -289.00000000000017, -233.19999999999965, -261.8000000000002, -280.60000000000014, -191.1999999999997, -216.89999999999958, -215.79999999999995, -185.69999999999973, -273.30000000000047, -226.80000000000035, -250.6000000000002, -196.9000000000003, -252.99999999999977, -232.40000000000003, -248.09999999999997, -274.29999999999984, -198.69999999999985, -233.70000000000044, -236.8000000000002, -285.69999999999993, -273.00000000000006, -296.60000000000025, -238.19999999999962, -259.9999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.042559308970006, "mean_inference_ms": 1.9815754821908758, "mean_action_processing_ms": 0.17151927060007488, "mean_env_wait_ms": 19.325577489682104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 16277.431, "load_time_ms": 8.981, "load_throughput": 445369.46, "learn_time_ms": 3305.825, "learn_throughput": 1209.985, "synch_weights_time_ms": 2.555}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-55-07", "timestamp": 1678550107, "time_this_iter_s": 13.833093643188477, "time_total_s": 146.5899076461792, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183aff70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183ac9d0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 146.5899076461792, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 70.52631578947368, "ram_util_percent": 17.794736842105266}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6688877667150189, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 5.000000000000001e-05, "total_loss": 9.786501930605981, "policy_loss": -0.010779755896017436, "vf_loss": 9.802073161832748, "vf_explained_var": -3.40755908719955e-05, "kl": 0.004160548859435303, "entropy": 4.793081691188197, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -143.0999999999999, "episode_reward_min": -890.2000000000012, "episode_reward_mean": -268.118, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-256.1, -237.20000000000044, -224.90000000000015, -557.7999999999993, -246.09999999999954, -200.8000000000003, -336.5000000000001, -280.30000000000007, -252.8000000000001, -238.59999999999988, -243.40000000000012, -237.19999999999985, -201.70000000000005, -568.300000000001, -244.89999999999995, -239.80000000000038, -207.4999999999998, -886.4000000000003, -255.39999999999998, -193.89999999999978, -291.8, -273.49999999999994, -303.10000000000025, -890.2000000000012, -270.20000000000005, -223.30000000000013, -304.9, -255.30000000000004, -247.60000000000025, -246.50000000000037, -282.8000000000005, -253.40000000000035, -239.20000000000013, -199.60000000000016, -265.0999999999996, -176.89999999999998, -289.00000000000017, -233.19999999999965, -261.8000000000002, -280.60000000000014, -191.1999999999997, -216.89999999999958, -215.79999999999995, -185.69999999999973, -273.30000000000047, -226.80000000000035, -250.6000000000002, -196.9000000000003, -252.99999999999977, -232.40000000000003, -248.09999999999997, -274.29999999999984, -198.69999999999985, -233.70000000000044, -236.8000000000002, -285.69999999999993, -273.00000000000006, -296.60000000000025, -238.19999999999962, -259.9999999999999, -263.9000000000002, -225.60000000000042, -221.60000000000042, -222.29999999999998, -204.59999999999954, -206.2, -263.49999999999994, -247.59999999999988, -239.69999999999993, -191.80000000000015, -214.79999999999984, -268.0000000000002, -275.9000000000003, -248.00000000000045, -254.89999999999966, -284.09999999999997, -194.30000000000015, -209.1000000000001, -272.20000000000005, -308.2000000000002, -238.99999999999991, -234.1000000000003, -219.3000000000001, -239.20000000000013, -355.2000000000001, -190.80000000000027, -221.60000000000008, -234.00000000000006, -225.70000000000027, -190.20000000000024, -218.59999999999997, -462.7000000000002, -258.2000000000004, -287.3000000000001, -278.29999999999967, -286.4999999999999, -205.80000000000015, -547.5000000000002, -273.0999999999995, -143.0999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.052372226022762, "mean_inference_ms": 1.9853502724551193, "mean_action_processing_ms": 0.17052826429934384, "mean_env_wait_ms": 19.31234347590639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -143.0999999999999, "episode_reward_min": -890.2000000000012, "episode_reward_mean": -268.118, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-256.1, -237.20000000000044, -224.90000000000015, -557.7999999999993, -246.09999999999954, -200.8000000000003, -336.5000000000001, -280.30000000000007, -252.8000000000001, -238.59999999999988, -243.40000000000012, -237.19999999999985, -201.70000000000005, -568.300000000001, -244.89999999999995, -239.80000000000038, -207.4999999999998, -886.4000000000003, -255.39999999999998, -193.89999999999978, -291.8, -273.49999999999994, -303.10000000000025, -890.2000000000012, -270.20000000000005, -223.30000000000013, -304.9, -255.30000000000004, -247.60000000000025, -246.50000000000037, -282.8000000000005, -253.40000000000035, -239.20000000000013, -199.60000000000016, -265.0999999999996, -176.89999999999998, -289.00000000000017, -233.19999999999965, -261.8000000000002, -280.60000000000014, -191.1999999999997, -216.89999999999958, -215.79999999999995, -185.69999999999973, -273.30000000000047, -226.80000000000035, -250.6000000000002, -196.9000000000003, -252.99999999999977, -232.40000000000003, -248.09999999999997, -274.29999999999984, -198.69999999999985, -233.70000000000044, -236.8000000000002, -285.69999999999993, -273.00000000000006, -296.60000000000025, -238.19999999999962, -259.9999999999999, -263.9000000000002, -225.60000000000042, -221.60000000000042, -222.29999999999998, -204.59999999999954, -206.2, -263.49999999999994, -247.59999999999988, -239.69999999999993, -191.80000000000015, -214.79999999999984, -268.0000000000002, -275.9000000000003, -248.00000000000045, -254.89999999999966, -284.09999999999997, -194.30000000000015, -209.1000000000001, -272.20000000000005, -308.2000000000002, -238.99999999999991, -234.1000000000003, -219.3000000000001, -239.20000000000013, -355.2000000000001, -190.80000000000027, -221.60000000000008, -234.00000000000006, -225.70000000000027, -190.20000000000024, -218.59999999999997, -462.7000000000002, -258.2000000000004, -287.3000000000001, -278.29999999999967, -286.4999999999999, -205.80000000000015, -547.5000000000002, -273.0999999999995, -143.0999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.052372226022762, "mean_inference_ms": 1.9853502724551193, "mean_action_processing_ms": 0.17052826429934384, "mean_env_wait_ms": 19.31234347590639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 17379.889, "load_time_ms": 9.858, "load_throughput": 405743.652, "learn_time_ms": 3452.287, "learn_throughput": 1158.652, "synch_weights_time_ms": 2.555}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-55-34", "timestamp": 1678550134, "time_this_iter_s": 27.32370138168335, "time_total_s": 173.91360902786255, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c42e0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c56c0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 173.91360902786255, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 100.0, "ram_util_percent": 22.81282051282051}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6766308406668324, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.805671876476657, "policy_loss": -0.012584540863791781, "vf_loss": 9.822973082142491, "vf_explained_var": -7.959585036000898e-05, "kl": 0.005273811297785476, "entropy": 4.71769486242725, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -143.0999999999999, "episode_reward_min": -547.5000000000002, "episode_reward_mean": -256.1550000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.1999999999997, -216.89999999999958, -215.79999999999995, -185.69999999999973, -273.30000000000047, -226.80000000000035, -250.6000000000002, -196.9000000000003, -252.99999999999977, -232.40000000000003, -248.09999999999997, -274.29999999999984, -198.69999999999985, -233.70000000000044, -236.8000000000002, -285.69999999999993, -273.00000000000006, -296.60000000000025, -238.19999999999962, -259.9999999999999, -263.9000000000002, -225.60000000000042, -221.60000000000042, -222.29999999999998, -204.59999999999954, -206.2, -263.49999999999994, -247.59999999999988, -239.69999999999993, -191.80000000000015, -214.79999999999984, -268.0000000000002, -275.9000000000003, -248.00000000000045, -254.89999999999966, -284.09999999999997, -194.30000000000015, -209.1000000000001, -272.20000000000005, -308.2000000000002, -238.99999999999991, -234.1000000000003, -219.3000000000001, -239.20000000000013, -355.2000000000001, -190.80000000000027, -221.60000000000008, -234.00000000000006, -225.70000000000027, -190.20000000000024, -218.59999999999997, -462.7000000000002, -258.2000000000004, -287.3000000000001, -278.29999999999967, -286.4999999999999, -205.80000000000015, -547.5000000000002, -273.0999999999995, -143.0999999999999, -294.1000000000003, -279.80000000000024, -296.6000000000001, -241.60000000000022, -508.2000000000003, -239.49999999999972, -234.00000000000028, -372.39999999999975, -276.59999999999974, -219.9999999999999, -250.00000000000009, -312.3000000000006, -287.4000000000001, -288.0, -195.30000000000013, -215.60000000000025, -190.3, -233.69999999999953, -232.49999999999997, -219.0999999999999, -275.70000000000016, -239.7999999999998, -373.8000000000009, -246.20000000000016, -236.5000000000003, -302.1000000000004, -183.59999999999962, -262.90000000000026, -223.5, -233.8000000000001, -239.1000000000003, -251.49999999999977, -264.3000000000003, -286.0999999999998, -239.50000000000017, -450.49999999999943, -252.69999999999993, -239.7000000000001, -282.5000000000002, -230.5000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.094737268229999, "mean_inference_ms": 2.0121321121583717, "mean_action_processing_ms": 0.17141551227546348, "mean_env_wait_ms": 19.53948005630641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -143.0999999999999, "episode_reward_min": -547.5000000000002, "episode_reward_mean": -256.1550000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-191.1999999999997, -216.89999999999958, -215.79999999999995, -185.69999999999973, -273.30000000000047, -226.80000000000035, -250.6000000000002, -196.9000000000003, -252.99999999999977, -232.40000000000003, -248.09999999999997, -274.29999999999984, -198.69999999999985, -233.70000000000044, -236.8000000000002, -285.69999999999993, -273.00000000000006, -296.60000000000025, -238.19999999999962, -259.9999999999999, -263.9000000000002, -225.60000000000042, -221.60000000000042, -222.29999999999998, -204.59999999999954, -206.2, -263.49999999999994, -247.59999999999988, -239.69999999999993, -191.80000000000015, -214.79999999999984, -268.0000000000002, -275.9000000000003, -248.00000000000045, -254.89999999999966, -284.09999999999997, -194.30000000000015, -209.1000000000001, -272.20000000000005, -308.2000000000002, -238.99999999999991, -234.1000000000003, -219.3000000000001, -239.20000000000013, -355.2000000000001, -190.80000000000027, -221.60000000000008, -234.00000000000006, -225.70000000000027, -190.20000000000024, -218.59999999999997, -462.7000000000002, -258.2000000000004, -287.3000000000001, -278.29999999999967, -286.4999999999999, -205.80000000000015, -547.5000000000002, -273.0999999999995, -143.0999999999999, -294.1000000000003, -279.80000000000024, -296.6000000000001, -241.60000000000022, -508.2000000000003, -239.49999999999972, -234.00000000000028, -372.39999999999975, -276.59999999999974, -219.9999999999999, -250.00000000000009, -312.3000000000006, -287.4000000000001, -288.0, -195.30000000000013, -215.60000000000025, -190.3, -233.69999999999953, -232.49999999999997, -219.0999999999999, -275.70000000000016, -239.7999999999998, -373.8000000000009, -246.20000000000016, -236.5000000000003, -302.1000000000004, -183.59999999999962, -262.90000000000026, -223.5, -233.8000000000001, -239.1000000000003, -251.49999999999977, -264.3000000000003, -286.0999999999998, -239.50000000000017, -450.49999999999943, -252.69999999999993, -239.7000000000001, -282.5000000000002, -230.5000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.094737268229999, "mean_inference_ms": 2.0121321121583717, "mean_action_processing_ms": 0.17141551227546348, "mean_env_wait_ms": 19.53948005630641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 17689.007, "load_time_ms": 10.513, "load_throughput": 380490.093, "learn_time_ms": 3463.673, "learn_throughput": 1154.844, "synch_weights_time_ms": 2.504}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-55-48", "timestamp": 1678550148, "time_this_iter_s": 13.55128026008606, "time_total_s": 187.4648892879486, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183adb10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183aea70>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 187.4648892879486, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 64.19, "ram_util_percent": 17.895}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6497377841703353, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 9.786262484519712, "policy_loss": -0.008890185783046388, "vf_loss": 9.799841677758002, "vf_explained_var": -0.00012637588285630748, "kl": 0.0034193500306396746, "entropy": 4.689622009954145, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -142.89999999999998, "episode_reward_min": -547.5000000000002, "episode_reward_mean": -256.68300000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.99999999999991, -234.1000000000003, -219.3000000000001, -239.20000000000013, -355.2000000000001, -190.80000000000027, -221.60000000000008, -234.00000000000006, -225.70000000000027, -190.20000000000024, -218.59999999999997, -462.7000000000002, -258.2000000000004, -287.3000000000001, -278.29999999999967, -286.4999999999999, -205.80000000000015, -547.5000000000002, -273.0999999999995, -143.0999999999999, -294.1000000000003, -279.80000000000024, -296.6000000000001, -241.60000000000022, -508.2000000000003, -239.49999999999972, -234.00000000000028, -372.39999999999975, -276.59999999999974, -219.9999999999999, -250.00000000000009, -312.3000000000006, -287.4000000000001, -288.0, -195.30000000000013, -215.60000000000025, -190.3, -233.69999999999953, -232.49999999999997, -219.0999999999999, -275.70000000000016, -239.7999999999998, -373.8000000000009, -246.20000000000016, -236.5000000000003, -302.1000000000004, -183.59999999999962, -262.90000000000026, -223.5, -233.8000000000001, -239.1000000000003, -251.49999999999977, -264.3000000000003, -286.0999999999998, -239.50000000000017, -450.49999999999943, -252.69999999999993, -239.7000000000001, -282.5000000000002, -230.5000000000001, -191.9000000000001, -313.0000000000001, -241.3000000000003, -189.00000000000009, -219.80000000000018, -241.69999999999982, -251.29999999999984, -254.89999999999975, -159.8999999999998, -290.8, -246.40000000000006, -275.1, -209.10000000000016, -172.30000000000007, -222.9999999999996, -218.49999999999974, -240.00000000000009, -289.1999999999999, -224.90000000000006, -208.10000000000002, -253.1999999999995, -280.8999999999999, -263.5999999999998, -210.70000000000016, -342.00000000000006, -208.59999999999977, -249.20000000000002, -259.4999999999999, -241.90000000000043, -208.69999999999956, -142.89999999999998, -258.7000000000003, -239.50000000000034, -248.59999999999962, -242.79999999999998, -212.3000000000001, -199.29999999999978, -412.09999999999974, -286.39999999999986, -235.6999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.0543153468357085, "mean_inference_ms": 2.0036059529050503, "mean_action_processing_ms": 0.1700437998928124, "mean_env_wait_ms": 19.45028945432058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -142.89999999999998, "episode_reward_min": -547.5000000000002, "episode_reward_mean": -256.68300000000005, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-238.99999999999991, -234.1000000000003, -219.3000000000001, -239.20000000000013, -355.2000000000001, -190.80000000000027, -221.60000000000008, -234.00000000000006, -225.70000000000027, -190.20000000000024, -218.59999999999997, -462.7000000000002, -258.2000000000004, -287.3000000000001, -278.29999999999967, -286.4999999999999, -205.80000000000015, -547.5000000000002, -273.0999999999995, -143.0999999999999, -294.1000000000003, -279.80000000000024, -296.6000000000001, -241.60000000000022, -508.2000000000003, -239.49999999999972, -234.00000000000028, -372.39999999999975, -276.59999999999974, -219.9999999999999, -250.00000000000009, -312.3000000000006, -287.4000000000001, -288.0, -195.30000000000013, -215.60000000000025, -190.3, -233.69999999999953, -232.49999999999997, -219.0999999999999, -275.70000000000016, -239.7999999999998, -373.8000000000009, -246.20000000000016, -236.5000000000003, -302.1000000000004, -183.59999999999962, -262.90000000000026, -223.5, -233.8000000000001, -239.1000000000003, -251.49999999999977, -264.3000000000003, -286.0999999999998, -239.50000000000017, -450.49999999999943, -252.69999999999993, -239.7000000000001, -282.5000000000002, -230.5000000000001, -191.9000000000001, -313.0000000000001, -241.3000000000003, -189.00000000000009, -219.80000000000018, -241.69999999999982, -251.29999999999984, -254.89999999999975, -159.8999999999998, -290.8, -246.40000000000006, -275.1, -209.10000000000016, -172.30000000000007, -222.9999999999996, -218.49999999999974, -240.00000000000009, -289.1999999999999, -224.90000000000006, -208.10000000000002, -253.1999999999995, -280.8999999999999, -263.5999999999998, -210.70000000000016, -342.00000000000006, -208.59999999999977, -249.20000000000002, -259.4999999999999, -241.90000000000043, -208.69999999999956, -142.89999999999998, -258.7000000000003, -239.50000000000034, -248.59999999999962, -242.79999999999998, -212.3000000000001, -199.29999999999978, -412.09999999999974, -286.39999999999986, -235.6999999999999], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.0543153468357085, "mean_inference_ms": 2.0036059529050503, "mean_action_processing_ms": 0.1700437998928124, "mean_env_wait_ms": 19.45028945432058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 17689.712, "load_time_ms": 10.665, "load_throughput": 375074.972, "learn_time_ms": 3466.41, "learn_throughput": 1153.932, "synch_weights_time_ms": 2.498}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-55-58", "timestamp": 1678550158, "time_this_iter_s": 10.550431966781616, "time_total_s": 198.01532125473022, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c5d50>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c5630>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 198.01532125473022, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 45.873333333333335, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6927833368701319, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 5.000000000000001e-05, "total_loss": 9.769518141592702, "policy_loss": -0.0068573890223858815, "vf_loss": 9.781084832837506, "vf_explained_var": -0.00015209413343860256, "kl": 0.0034401661612974152, "entropy": 4.709639775368475, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -142.89999999999998, "episode_reward_min": -450.49999999999943, "episode_reward_mean": -240.80600000000007, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-275.70000000000016, -239.7999999999998, -373.8000000000009, -246.20000000000016, -236.5000000000003, -302.1000000000004, -183.59999999999962, -262.90000000000026, -223.5, -233.8000000000001, -239.1000000000003, -251.49999999999977, -264.3000000000003, -286.0999999999998, -239.50000000000017, -450.49999999999943, -252.69999999999993, -239.7000000000001, -282.5000000000002, -230.5000000000001, -191.9000000000001, -313.0000000000001, -241.3000000000003, -189.00000000000009, -219.80000000000018, -241.69999999999982, -251.29999999999984, -254.89999999999975, -159.8999999999998, -290.8, -246.40000000000006, -275.1, -209.10000000000016, -172.30000000000007, -222.9999999999996, -218.49999999999974, -240.00000000000009, -289.1999999999999, -224.90000000000006, -208.10000000000002, -253.1999999999995, -280.8999999999999, -263.5999999999998, -210.70000000000016, -342.00000000000006, -208.59999999999977, -249.20000000000002, -259.4999999999999, -241.90000000000043, -208.69999999999956, -142.89999999999998, -258.7000000000003, -239.50000000000034, -248.59999999999962, -242.79999999999998, -212.3000000000001, -199.29999999999978, -412.09999999999974, -286.39999999999986, -235.6999999999999, -262.09999999999985, -248.00000000000006, -191.50000000000026, -266.59999999999985, -207.99999999999991, -226.0000000000002, -254.8000000000004, -252.30000000000018, -207.1000000000002, -262.9000000000003, -223.50000000000037, -220.50000000000003, -221.80000000000013, -203.8999999999997, -253.90000000000006, -263.5000000000002, -263.3000000000001, -295.1000000000004, -212.9000000000003, -159.59999999999985, -171.80000000000007, -226.10000000000025, -274.10000000000036, -206.40000000000003, -233.39999999999995, -184.50000000000006, -206.0000000000003, -195.99999999999997, -268.2000000000004, -246.70000000000022, -239.60000000000008, -247.4000000000003, -207.90000000000035, -213.7999999999998, -219.1000000000001, -166.10000000000005, -253.20000000000041, -230.3000000000003, -149.29999999999973, -272.30000000000024], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.020493737710068, "mean_inference_ms": 1.9873909355933126, "mean_action_processing_ms": 0.16931137580991037, "mean_env_wait_ms": 19.35197732848218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -142.89999999999998, "episode_reward_min": -450.49999999999943, "episode_reward_mean": -240.80600000000007, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-275.70000000000016, -239.7999999999998, -373.8000000000009, -246.20000000000016, -236.5000000000003, -302.1000000000004, -183.59999999999962, -262.90000000000026, -223.5, -233.8000000000001, -239.1000000000003, -251.49999999999977, -264.3000000000003, -286.0999999999998, -239.50000000000017, -450.49999999999943, -252.69999999999993, -239.7000000000001, -282.5000000000002, -230.5000000000001, -191.9000000000001, -313.0000000000001, -241.3000000000003, -189.00000000000009, -219.80000000000018, -241.69999999999982, -251.29999999999984, -254.89999999999975, -159.8999999999998, -290.8, -246.40000000000006, -275.1, -209.10000000000016, -172.30000000000007, -222.9999999999996, -218.49999999999974, -240.00000000000009, -289.1999999999999, -224.90000000000006, -208.10000000000002, -253.1999999999995, -280.8999999999999, -263.5999999999998, -210.70000000000016, -342.00000000000006, -208.59999999999977, -249.20000000000002, -259.4999999999999, -241.90000000000043, -208.69999999999956, -142.89999999999998, -258.7000000000003, -239.50000000000034, -248.59999999999962, -242.79999999999998, -212.3000000000001, -199.29999999999978, -412.09999999999974, -286.39999999999986, -235.6999999999999, -262.09999999999985, -248.00000000000006, -191.50000000000026, -266.59999999999985, -207.99999999999991, -226.0000000000002, -254.8000000000004, -252.30000000000018, -207.1000000000002, -262.9000000000003, -223.50000000000037, -220.50000000000003, -221.80000000000013, -203.8999999999997, -253.90000000000006, -263.5000000000002, -263.3000000000001, -295.1000000000004, -212.9000000000003, -159.59999999999985, -171.80000000000007, -226.10000000000025, -274.10000000000036, -206.40000000000003, -233.39999999999995, -184.50000000000006, -206.0000000000003, -195.99999999999997, -268.2000000000004, -246.70000000000022, -239.60000000000008, -247.4000000000003, -207.90000000000035, -213.7999999999998, -219.1000000000001, -166.10000000000005, -253.20000000000041, -230.3000000000003, -149.29999999999973, -272.30000000000024], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.020493737710068, "mean_inference_ms": 1.9873909355933126, "mean_action_processing_ms": 0.16931137580991037, "mean_env_wait_ms": 19.35197732848218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 17405.957, "load_time_ms": 10.509, "load_throughput": 380635.117, "learn_time_ms": 3478.702, "learn_throughput": 1149.854, "synch_weights_time_ms": 2.506}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-56-22", "timestamp": 1678550182, "time_this_iter_s": 23.728118658065796, "time_total_s": 221.74343991279602, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183ae1d0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183ae500>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 221.74343991279602, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 94.98181818181818, "ram_util_percent": 20.757575757575758}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6708377725655033, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 5.000000000000001e-05, "total_loss": 9.789939554276005, "policy_loss": -0.014869682809277888, "vf_loss": 9.809481211631528, "vf_explained_var": -0.00015947453437312957, "kl": 0.005221711568134592, "entropy": 4.672050408394106, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -142.89999999999998, "episode_reward_min": -866.900000000001, "episode_reward_mean": -237.58100000000005, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-253.1999999999995, -280.8999999999999, -263.5999999999998, -210.70000000000016, -342.00000000000006, -208.59999999999977, -249.20000000000002, -259.4999999999999, -241.90000000000043, -208.69999999999956, -142.89999999999998, -258.7000000000003, -239.50000000000034, -248.59999999999962, -242.79999999999998, -212.3000000000001, -199.29999999999978, -412.09999999999974, -286.39999999999986, -235.6999999999999, -262.09999999999985, -248.00000000000006, -191.50000000000026, -266.59999999999985, -207.99999999999991, -226.0000000000002, -254.8000000000004, -252.30000000000018, -207.1000000000002, -262.9000000000003, -223.50000000000037, -220.50000000000003, -221.80000000000013, -203.8999999999997, -253.90000000000006, -263.5000000000002, -263.3000000000001, -295.1000000000004, -212.9000000000003, -159.59999999999985, -171.80000000000007, -226.10000000000025, -274.10000000000036, -206.40000000000003, -233.39999999999995, -184.50000000000006, -206.0000000000003, -195.99999999999997, -268.2000000000004, -246.70000000000022, -239.60000000000008, -247.4000000000003, -207.90000000000035, -213.7999999999998, -219.1000000000001, -166.10000000000005, -253.20000000000041, -230.3000000000003, -149.29999999999973, -272.30000000000024, -250.8999999999998, -162.79999999999978, -219.29999999999967, -302.7, -270.4000000000001, -250.10000000000008, -231.5999999999996, -866.900000000001, -228.69999999999968, -192.50000000000028, -229.6000000000004, -251.7000000000001, -275.1, -218.50000000000023, -217.50000000000026, -259.3999999999997, -239.7000000000002, -295.0000000000003, -252.20000000000027, -246.20000000000041, -213.90000000000026, -248.60000000000034, -217.10000000000034, -193.1, -235.60000000000014, -188.70000000000024, -226.00000000000028, -225.19999999999982, -249.10000000000016, -212.10000000000005, -217.90000000000043, -231.0000000000002, -190.69999999999965, -189.00000000000048, -185.19999999999987, -166.20000000000024, -211.09999999999997, -198.79999999999995, -187.99999999999997, -203.90000000000006], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.09102915182178, "mean_inference_ms": 2.0203959210678453, "mean_action_processing_ms": 0.17256088633950312, "mean_env_wait_ms": 19.678381589059533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -142.89999999999998, "episode_reward_min": -866.900000000001, "episode_reward_mean": -237.58100000000005, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-253.1999999999995, -280.8999999999999, -263.5999999999998, -210.70000000000016, -342.00000000000006, -208.59999999999977, -249.20000000000002, -259.4999999999999, -241.90000000000043, -208.69999999999956, -142.89999999999998, -258.7000000000003, -239.50000000000034, -248.59999999999962, -242.79999999999998, -212.3000000000001, -199.29999999999978, -412.09999999999974, -286.39999999999986, -235.6999999999999, -262.09999999999985, -248.00000000000006, -191.50000000000026, -266.59999999999985, -207.99999999999991, -226.0000000000002, -254.8000000000004, -252.30000000000018, -207.1000000000002, -262.9000000000003, -223.50000000000037, -220.50000000000003, -221.80000000000013, -203.8999999999997, -253.90000000000006, -263.5000000000002, -263.3000000000001, -295.1000000000004, -212.9000000000003, -159.59999999999985, -171.80000000000007, -226.10000000000025, -274.10000000000036, -206.40000000000003, -233.39999999999995, -184.50000000000006, -206.0000000000003, -195.99999999999997, -268.2000000000004, -246.70000000000022, -239.60000000000008, -247.4000000000003, -207.90000000000035, -213.7999999999998, -219.1000000000001, -166.10000000000005, -253.20000000000041, -230.3000000000003, -149.29999999999973, -272.30000000000024, -250.8999999999998, -162.79999999999978, -219.29999999999967, -302.7, -270.4000000000001, -250.10000000000008, -231.5999999999996, -866.900000000001, -228.69999999999968, -192.50000000000028, -229.6000000000004, -251.7000000000001, -275.1, -218.50000000000023, -217.50000000000026, -259.3999999999997, -239.7000000000002, -295.0000000000003, -252.20000000000027, -246.20000000000041, -213.90000000000026, -248.60000000000034, -217.10000000000034, -193.1, -235.60000000000014, -188.70000000000024, -226.00000000000028, -225.19999999999982, -249.10000000000016, -212.10000000000005, -217.90000000000043, -231.0000000000002, -190.69999999999965, -189.00000000000048, -185.19999999999987, -166.20000000000024, -211.09999999999997, -198.79999999999995, -187.99999999999997, -203.90000000000006], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.09102915182178, "mean_inference_ms": 2.0203959210678453, "mean_action_processing_ms": 0.17256088633950312, "mean_env_wait_ms": 19.678381589059533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 17714.229, "load_time_ms": 10.529, "load_throughput": 379911.098, "learn_time_ms": 3468.092, "learn_throughput": 1153.372, "synch_weights_time_ms": 2.515}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-56-44", "timestamp": 1678550204, "time_this_iter_s": 21.981373071670532, "time_total_s": 243.72481298446655, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18531900>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18531ff0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 243.72481298446655, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 86.83125000000001, "ram_util_percent": 21.728125}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6807819523157612, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 5.000000000000001e-05, "total_loss": 9.773926519578502, "policy_loss": -0.005411661649122834, "vf_loss": 9.78398037264424, "vf_explained_var": -0.00017187787640479302, "kl": 0.003283641196941367, "entropy": 4.6421071621679495, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -149.29999999999973, "episode_reward_min": -866.900000000001, "episode_reward_mean": -231.47700000000012, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.80000000000007, -226.10000000000025, -274.10000000000036, -206.40000000000003, -233.39999999999995, -184.50000000000006, -206.0000000000003, -195.99999999999997, -268.2000000000004, -246.70000000000022, -239.60000000000008, -247.4000000000003, -207.90000000000035, -213.7999999999998, -219.1000000000001, -166.10000000000005, -253.20000000000041, -230.3000000000003, -149.29999999999973, -272.30000000000024, -250.8999999999998, -162.79999999999978, -219.29999999999967, -302.7, -270.4000000000001, -250.10000000000008, -231.5999999999996, -866.900000000001, -228.69999999999968, -192.50000000000028, -229.6000000000004, -251.7000000000001, -275.1, -218.50000000000023, -217.50000000000026, -259.3999999999997, -239.7000000000002, -295.0000000000003, -252.20000000000027, -246.20000000000041, -213.90000000000026, -248.60000000000034, -217.10000000000034, -193.1, -235.60000000000014, -188.70000000000024, -226.00000000000028, -225.19999999999982, -249.10000000000016, -212.10000000000005, -217.90000000000043, -231.0000000000002, -190.69999999999965, -189.00000000000048, -185.19999999999987, -166.20000000000024, -211.09999999999997, -198.79999999999995, -187.99999999999997, -203.90000000000006, -219.99999999999963, -185.89999999999964, -202.6000000000004, -225.40000000000018, -197.3999999999999, -221.29999999999998, -234.70000000000024, -229.60000000000002, -247.9000000000002, -268.4000000000003, -209.1999999999998, -222.30000000000035, -232.39999999999966, -169.1, -203.59999999999988, -195.5000000000001, -182.4, -215.30000000000007, -230.29999999999973, -266.2000000000001, -278.00000000000006, -254.9000000000003, -251.50000000000037, -243.10000000000002, -199.60000000000016, -259.1000000000003, -258.5000000000002, -239.39999999999972, -197.99999999999972, -211.20000000000022, -216.29999999999967, -252.20000000000024, -276.70000000000016, -255.50000000000023, -219.69999999999982, -170.6, -216.20000000000013, -245.69999999999956, -230.09999999999985, -247.70000000000007], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.1197065232562915, "mean_inference_ms": 2.0346988422048273, "mean_action_processing_ms": 0.17433401468763648, "mean_env_wait_ms": 19.80746549672928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -149.29999999999973, "episode_reward_min": -866.900000000001, "episode_reward_mean": -231.47700000000012, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-171.80000000000007, -226.10000000000025, -274.10000000000036, -206.40000000000003, -233.39999999999995, -184.50000000000006, -206.0000000000003, -195.99999999999997, -268.2000000000004, -246.70000000000022, -239.60000000000008, -247.4000000000003, -207.90000000000035, -213.7999999999998, -219.1000000000001, -166.10000000000005, -253.20000000000041, -230.3000000000003, -149.29999999999973, -272.30000000000024, -250.8999999999998, -162.79999999999978, -219.29999999999967, -302.7, -270.4000000000001, -250.10000000000008, -231.5999999999996, -866.900000000001, -228.69999999999968, -192.50000000000028, -229.6000000000004, -251.7000000000001, -275.1, -218.50000000000023, -217.50000000000026, -259.3999999999997, -239.7000000000002, -295.0000000000003, -252.20000000000027, -246.20000000000041, -213.90000000000026, -248.60000000000034, -217.10000000000034, -193.1, -235.60000000000014, -188.70000000000024, -226.00000000000028, -225.19999999999982, -249.10000000000016, -212.10000000000005, -217.90000000000043, -231.0000000000002, -190.69999999999965, -189.00000000000048, -185.19999999999987, -166.20000000000024, -211.09999999999997, -198.79999999999995, -187.99999999999997, -203.90000000000006, -219.99999999999963, -185.89999999999964, -202.6000000000004, -225.40000000000018, -197.3999999999999, -221.29999999999998, -234.70000000000024, -229.60000000000002, -247.9000000000002, -268.4000000000003, -209.1999999999998, -222.30000000000035, -232.39999999999966, -169.1, -203.59999999999988, -195.5000000000001, -182.4, -215.30000000000007, -230.29999999999973, -266.2000000000001, -278.00000000000006, -254.9000000000003, -251.50000000000037, -243.10000000000002, -199.60000000000016, -259.1000000000003, -258.5000000000002, -239.39999999999972, -197.99999999999972, -211.20000000000022, -216.29999999999967, -252.20000000000024, -276.70000000000016, -255.50000000000023, -219.69999999999982, -170.6, -216.20000000000013, -245.69999999999956, -230.09999999999985, -247.70000000000007], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.1197065232562915, "mean_inference_ms": 2.0346988422048273, "mean_action_processing_ms": 0.17433401468763648, "mean_env_wait_ms": 19.80746549672928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 17726.114, "load_time_ms": 10.605, "load_throughput": 377166.109, "learn_time_ms": 3463.458, "learn_throughput": 1154.915, "synch_weights_time_ms": 2.495}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-56-55", "timestamp": 1678550215, "time_this_iter_s": 10.53032898902893, "time_total_s": 254.25514197349548, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c42e0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c4370>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 254.25514197349548, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 45.940000000000005, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7355807505307659, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 5.000000000000001e-05, "total_loss": 9.739953948605445, "policy_loss": -0.008038293806114986, "vf_loss": 9.752602075761365, "vf_explained_var": -0.0001390957063244235, "kl": 0.0034346644460477274, "entropy": 4.609879870568553, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": -143.5, "episode_reward_min": -350.2999999999997, "episode_reward_mean": -223.46700000000007, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.90000000000026, -248.60000000000034, -217.10000000000034, -193.1, -235.60000000000014, -188.70000000000024, -226.00000000000028, -225.19999999999982, -249.10000000000016, -212.10000000000005, -217.90000000000043, -231.0000000000002, -190.69999999999965, -189.00000000000048, -185.19999999999987, -166.20000000000024, -211.09999999999997, -198.79999999999995, -187.99999999999997, -203.90000000000006, -219.99999999999963, -185.89999999999964, -202.6000000000004, -225.40000000000018, -197.3999999999999, -221.29999999999998, -234.70000000000024, -229.60000000000002, -247.9000000000002, -268.4000000000003, -209.1999999999998, -222.30000000000035, -232.39999999999966, -169.1, -203.59999999999988, -195.5000000000001, -182.4, -215.30000000000007, -230.29999999999973, -266.2000000000001, -278.00000000000006, -254.9000000000003, -251.50000000000037, -243.10000000000002, -199.60000000000016, -259.1000000000003, -258.5000000000002, -239.39999999999972, -197.99999999999972, -211.20000000000022, -216.29999999999967, -252.20000000000024, -276.70000000000016, -255.50000000000023, -219.69999999999982, -170.6, -216.20000000000013, -245.69999999999956, -230.09999999999985, -247.70000000000007, -249.40000000000003, -215.9999999999997, -231.60000000000034, -152.80000000000015, -193.90000000000006, -235.50000000000009, -187.79999999999998, -274.00000000000017, -263.39999999999975, -243.00000000000048, -230.90000000000015, -162.40000000000018, -283.9000000000005, -204.40000000000012, -229.30000000000024, -201.99999999999963, -198.20000000000024, -192.4000000000001, -241.60000000000042, -181.49999999999983, -143.5, -250.69999999999985, -240.29999999999993, -231.7000000000002, -172.1999999999997, -231.60000000000008, -350.2999999999997, -252.50000000000003, -247.2000000000004, -198.19999999999993, -269.6999999999998, -245.40000000000015, -233.60000000000002, -204.89999999999984, -262.9, -265.6000000000001, -204.2000000000004, -199.40000000000006, -232.89999999999975, -261.20000000000016], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.087251516104348, "mean_inference_ms": 2.0178707800461653, "mean_action_processing_ms": 0.17293808223614718, "mean_env_wait_ms": 19.632970390396164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -143.5, "episode_reward_min": -350.2999999999997, "episode_reward_mean": -223.46700000000007, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-213.90000000000026, -248.60000000000034, -217.10000000000034, -193.1, -235.60000000000014, -188.70000000000024, -226.00000000000028, -225.19999999999982, -249.10000000000016, -212.10000000000005, -217.90000000000043, -231.0000000000002, -190.69999999999965, -189.00000000000048, -185.19999999999987, -166.20000000000024, -211.09999999999997, -198.79999999999995, -187.99999999999997, -203.90000000000006, -219.99999999999963, -185.89999999999964, -202.6000000000004, -225.40000000000018, -197.3999999999999, -221.29999999999998, -234.70000000000024, -229.60000000000002, -247.9000000000002, -268.4000000000003, -209.1999999999998, -222.30000000000035, -232.39999999999966, -169.1, -203.59999999999988, -195.5000000000001, -182.4, -215.30000000000007, -230.29999999999973, -266.2000000000001, -278.00000000000006, -254.9000000000003, -251.50000000000037, -243.10000000000002, -199.60000000000016, -259.1000000000003, -258.5000000000002, -239.39999999999972, -197.99999999999972, -211.20000000000022, -216.29999999999967, -252.20000000000024, -276.70000000000016, -255.50000000000023, -219.69999999999982, -170.6, -216.20000000000013, -245.69999999999956, -230.09999999999985, -247.70000000000007, -249.40000000000003, -215.9999999999997, -231.60000000000034, -152.80000000000015, -193.90000000000006, -235.50000000000009, -187.79999999999998, -274.00000000000017, -263.39999999999975, -243.00000000000048, -230.90000000000015, -162.40000000000018, -283.9000000000005, -204.40000000000012, -229.30000000000024, -201.99999999999963, -198.20000000000024, -192.4000000000001, -241.60000000000042, -181.49999999999983, -143.5, -250.69999999999985, -240.29999999999993, -231.7000000000002, -172.1999999999997, -231.60000000000008, -350.2999999999997, -252.50000000000003, -247.2000000000004, -198.19999999999993, -269.6999999999998, -245.40000000000015, -233.60000000000002, -204.89999999999984, -262.9, -265.6000000000001, -204.2000000000004, -199.40000000000006, -232.89999999999975, -261.20000000000016], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.087251516104348, "mean_inference_ms": 2.0178707800461653, "mean_action_processing_ms": 0.17293808223614718, "mean_env_wait_ms": 19.632970390396164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 17446.914, "load_time_ms": 11.652, "load_throughput": 343288.216, "learn_time_ms": 3492.201, "learn_throughput": 1145.409, "synch_weights_time_ms": 2.507}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-57-12", "timestamp": 1678550232, "time_this_iter_s": 17.341243505477905, "time_total_s": 271.5963854789734, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183d0220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183d02b0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 271.5963854789734, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 83.17916666666666, "ram_util_percent": 19.037499999999998}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7413940992086164, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 5.000000000000001e-05, "total_loss": 9.777311537342687, "policy_loss": -0.008121512632726901, "vf_loss": 9.789952210457095, "vf_explained_var": -0.00015583538240002048, "kl": 0.004491994937091608, "entropy": 4.5191845540077455, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": -143.5, "episode_reward_min": -350.2999999999997, "episode_reward_mean": -224.00300000000004, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.00000000000006, -254.9000000000003, -251.50000000000037, -243.10000000000002, -199.60000000000016, -259.1000000000003, -258.5000000000002, -239.39999999999972, -197.99999999999972, -211.20000000000022, -216.29999999999967, -252.20000000000024, -276.70000000000016, -255.50000000000023, -219.69999999999982, -170.6, -216.20000000000013, -245.69999999999956, -230.09999999999985, -247.70000000000007, -249.40000000000003, -215.9999999999997, -231.60000000000034, -152.80000000000015, -193.90000000000006, -235.50000000000009, -187.79999999999998, -274.00000000000017, -263.39999999999975, -243.00000000000048, -230.90000000000015, -162.40000000000018, -283.9000000000005, -204.40000000000012, -229.30000000000024, -201.99999999999963, -198.20000000000024, -192.4000000000001, -241.60000000000042, -181.49999999999983, -143.5, -250.69999999999985, -240.29999999999993, -231.7000000000002, -172.1999999999997, -231.60000000000008, -350.2999999999997, -252.50000000000003, -247.2000000000004, -198.19999999999993, -269.6999999999998, -245.40000000000015, -233.60000000000002, -204.89999999999984, -262.9, -265.6000000000001, -204.2000000000004, -199.40000000000006, -232.89999999999975, -261.20000000000016, -195.6000000000002, -238.0, -203.59999999999994, -228.00000000000009, -227.30000000000004, -236.30000000000015, -203.2999999999998, -192.4000000000002, -225.49999999999997, -220.59999999999954, -239.80000000000018, -244.59999999999957, -211.60000000000002, -206.59999999999994, -225.99999999999997, -234.0000000000003, -191.60000000000036, -187.80000000000013, -199.40000000000006, -160.99999999999994, -192.80000000000013, -270.6000000000004, -275.99999999999983, -244.2000000000003, -214.00000000000037, -177.80000000000018, -181.69999999999987, -239.49999999999997, -262.79999999999967, -178.10000000000008, -222.60000000000036, -211.8999999999998, -213.29999999999976, -248.90000000000026, -201.10000000000022, -147.69999999999993, -183.09999999999997, -217.70000000000022, -216.10000000000008, -231.40000000000015], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.115648629648652, "mean_inference_ms": 2.0355909284492055, "mean_action_processing_ms": 0.17385859873123521, "mean_env_wait_ms": 19.78380315007619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -143.5, "episode_reward_min": -350.2999999999997, "episode_reward_mean": -224.00300000000004, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-278.00000000000006, -254.9000000000003, -251.50000000000037, -243.10000000000002, -199.60000000000016, -259.1000000000003, -258.5000000000002, -239.39999999999972, -197.99999999999972, -211.20000000000022, -216.29999999999967, -252.20000000000024, -276.70000000000016, -255.50000000000023, -219.69999999999982, -170.6, -216.20000000000013, -245.69999999999956, -230.09999999999985, -247.70000000000007, -249.40000000000003, -215.9999999999997, -231.60000000000034, -152.80000000000015, -193.90000000000006, -235.50000000000009, -187.79999999999998, -274.00000000000017, -263.39999999999975, -243.00000000000048, -230.90000000000015, -162.40000000000018, -283.9000000000005, -204.40000000000012, -229.30000000000024, -201.99999999999963, -198.20000000000024, -192.4000000000001, -241.60000000000042, -181.49999999999983, -143.5, -250.69999999999985, -240.29999999999993, -231.7000000000002, -172.1999999999997, -231.60000000000008, -350.2999999999997, -252.50000000000003, -247.2000000000004, -198.19999999999993, -269.6999999999998, -245.40000000000015, -233.60000000000002, -204.89999999999984, -262.9, -265.6000000000001, -204.2000000000004, -199.40000000000006, -232.89999999999975, -261.20000000000016, -195.6000000000002, -238.0, -203.59999999999994, -228.00000000000009, -227.30000000000004, -236.30000000000015, -203.2999999999998, -192.4000000000002, -225.49999999999997, -220.59999999999954, -239.80000000000018, -244.59999999999957, -211.60000000000002, -206.59999999999994, -225.99999999999997, -234.0000000000003, -191.60000000000036, -187.80000000000013, -199.40000000000006, -160.99999999999994, -192.80000000000013, -270.6000000000004, -275.99999999999983, -244.2000000000003, -214.00000000000037, -177.80000000000018, -181.69999999999987, -239.49999999999997, -262.79999999999967, -178.10000000000008, -222.60000000000036, -211.8999999999998, -213.29999999999976, -248.90000000000026, -201.10000000000022, -147.69999999999993, -183.09999999999997, -217.70000000000022, -216.10000000000008, -231.40000000000015], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.115648629648652, "mean_inference_ms": 2.0355909284492055, "mean_action_processing_ms": 0.17385859873123521, "mean_env_wait_ms": 19.78380315007619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 17667.71, "load_time_ms": 11.874, "load_throughput": 336859.419, "learn_time_ms": 3657.862, "learn_throughput": 1093.535, "synch_weights_time_ms": 2.49}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-57-40", "timestamp": 1678550260, "time_this_iter_s": 27.305238723754883, "time_total_s": 298.90162420272827, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18533220>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18532a10>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 298.90162420272827, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 99.98974358974358, "ram_util_percent": 22.894871794871797}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7092351901915765, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 5.000000000000001e-05, "total_loss": 9.761782000141759, "policy_loss": -0.005995538190848405, "vf_loss": 9.772254897702124, "vf_explained_var": -0.00015543237809211976, "kl": 0.002751071514947127, "entropy": 4.477405520408384, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": -143.5, "episode_reward_min": -417.1999999999997, "episode_reward_mean": -222.6670000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.5, -250.69999999999985, -240.29999999999993, -231.7000000000002, -172.1999999999997, -231.60000000000008, -350.2999999999997, -252.50000000000003, -247.2000000000004, -198.19999999999993, -269.6999999999998, -245.40000000000015, -233.60000000000002, -204.89999999999984, -262.9, -265.6000000000001, -204.2000000000004, -199.40000000000006, -232.89999999999975, -261.20000000000016, -195.6000000000002, -238.0, -203.59999999999994, -228.00000000000009, -227.30000000000004, -236.30000000000015, -203.2999999999998, -192.4000000000002, -225.49999999999997, -220.59999999999954, -239.80000000000018, -244.59999999999957, -211.60000000000002, -206.59999999999994, -225.99999999999997, -234.0000000000003, -191.60000000000036, -187.80000000000013, -199.40000000000006, -160.99999999999994, -192.80000000000013, -270.6000000000004, -275.99999999999983, -244.2000000000003, -214.00000000000037, -177.80000000000018, -181.69999999999987, -239.49999999999997, -262.79999999999967, -178.10000000000008, -222.60000000000036, -211.8999999999998, -213.29999999999976, -248.90000000000026, -201.10000000000022, -147.69999999999993, -183.09999999999997, -217.70000000000022, -216.10000000000008, -231.40000000000015, -219.30000000000047, -254.69999999999976, -201.70000000000002, -166.70000000000027, -191.2000000000001, -217.3999999999997, -208.30000000000044, -259.70000000000005, -215.5000000000002, -202.60000000000008, -219.69999999999987, -207.00000000000017, -276.60000000000014, -204.90000000000015, -218.70000000000041, -159.79999999999993, -212.7000000000005, -183.19999999999968, -214.99999999999983, -201.40000000000018, -215.70000000000027, -205.50000000000034, -245.99999999999997, -201.5, -213.9000000000003, -186.50000000000003, -245.69999999999987, -248.80000000000013, -210.10000000000016, -211.49999999999977, -314.5999999999996, -213.7999999999998, -212.7999999999999, -232.89999999999958, -253.40000000000026, -262.7000000000004, -188.79999999999978, -233.70000000000044, -213.19999999999985, -417.1999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.132984960764868, "mean_inference_ms": 2.0470239245278425, "mean_action_processing_ms": 0.17433132334218576, "mean_env_wait_ms": 19.87951165354255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -143.5, "episode_reward_min": -417.1999999999997, "episode_reward_mean": -222.6670000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-143.5, -250.69999999999985, -240.29999999999993, -231.7000000000002, -172.1999999999997, -231.60000000000008, -350.2999999999997, -252.50000000000003, -247.2000000000004, -198.19999999999993, -269.6999999999998, -245.40000000000015, -233.60000000000002, -204.89999999999984, -262.9, -265.6000000000001, -204.2000000000004, -199.40000000000006, -232.89999999999975, -261.20000000000016, -195.6000000000002, -238.0, -203.59999999999994, -228.00000000000009, -227.30000000000004, -236.30000000000015, -203.2999999999998, -192.4000000000002, -225.49999999999997, -220.59999999999954, -239.80000000000018, -244.59999999999957, -211.60000000000002, -206.59999999999994, -225.99999999999997, -234.0000000000003, -191.60000000000036, -187.80000000000013, -199.40000000000006, -160.99999999999994, -192.80000000000013, -270.6000000000004, -275.99999999999983, -244.2000000000003, -214.00000000000037, -177.80000000000018, -181.69999999999987, -239.49999999999997, -262.79999999999967, -178.10000000000008, -222.60000000000036, -211.8999999999998, -213.29999999999976, -248.90000000000026, -201.10000000000022, -147.69999999999993, -183.09999999999997, -217.70000000000022, -216.10000000000008, -231.40000000000015, -219.30000000000047, -254.69999999999976, -201.70000000000002, -166.70000000000027, -191.2000000000001, -217.3999999999997, -208.30000000000044, -259.70000000000005, -215.5000000000002, -202.60000000000008, -219.69999999999987, -207.00000000000017, -276.60000000000014, -204.90000000000015, -218.70000000000041, -159.79999999999993, -212.7000000000005, -183.19999999999968, -214.99999999999983, -201.40000000000018, -215.70000000000027, -205.50000000000034, -245.99999999999997, -201.5, -213.9000000000003, -186.50000000000003, -245.69999999999987, -248.80000000000013, -210.10000000000016, -211.49999999999977, -314.5999999999996, -213.7999999999998, -212.7999999999999, -232.89999999999958, -253.40000000000026, -262.7000000000004, -188.79999999999978, -233.70000000000044, -213.19999999999985, -417.1999999999997], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.132984960764868, "mean_inference_ms": 2.0470239245278425, "mean_action_processing_ms": 0.17433132334218576, "mean_env_wait_ms": 19.87951165354255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 17660.2, "load_time_ms": 11.852, "load_throughput": 337486.216, "learn_time_ms": 3659.245, "learn_throughput": 1093.122, "synch_weights_time_ms": 2.498}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-57-50", "timestamp": 1678550270, "time_this_iter_s": 10.56053376197815, "time_total_s": 309.4621579647064, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c4a30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c6e00>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 309.4621579647064, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 47.81333333333335, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7258853637403058, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 5.000000000000001e-05, "total_loss": 9.767611534364763, "policy_loss": -0.005027410243037007, "vf_loss": 9.777115166571832, "vf_explained_var": -0.0001521756572108115, "kl": 0.003713325575190124, "entropy": 4.47617183654539, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": -136.10000000000002, "episode_reward_min": -417.1999999999997, "episode_reward_mean": -217.33900000000006, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-192.80000000000013, -270.6000000000004, -275.99999999999983, -244.2000000000003, -214.00000000000037, -177.80000000000018, -181.69999999999987, -239.49999999999997, -262.79999999999967, -178.10000000000008, -222.60000000000036, -211.8999999999998, -213.29999999999976, -248.90000000000026, -201.10000000000022, -147.69999999999993, -183.09999999999997, -217.70000000000022, -216.10000000000008, -231.40000000000015, -219.30000000000047, -254.69999999999976, -201.70000000000002, -166.70000000000027, -191.2000000000001, -217.3999999999997, -208.30000000000044, -259.70000000000005, -215.5000000000002, -202.60000000000008, -219.69999999999987, -207.00000000000017, -276.60000000000014, -204.90000000000015, -218.70000000000041, -159.79999999999993, -212.7000000000005, -183.19999999999968, -214.99999999999983, -201.40000000000018, -215.70000000000027, -205.50000000000034, -245.99999999999997, -201.5, -213.9000000000003, -186.50000000000003, -245.69999999999987, -248.80000000000013, -210.10000000000016, -211.49999999999977, -314.5999999999996, -213.7999999999998, -212.7999999999999, -232.89999999999958, -253.40000000000026, -262.7000000000004, -188.79999999999978, -233.70000000000044, -213.19999999999985, -417.1999999999997, -238.09999999999988, -194.00000000000017, -193.89999999999986, -136.10000000000002, -227.9999999999997, -201.90000000000018, -216.1000000000002, -201.49999999999983, -183.70000000000002, -165.69999999999968, -228.7999999999997, -182.40000000000023, -247.60000000000025, -240.4000000000001, -224.60000000000005, -194.20000000000027, -222.00000000000026, -194.59999999999974, -185.60000000000025, -194.40000000000018, -241.79999999999973, -196.5000000000002, -184.50000000000023, -189.49999999999994, -189.20000000000024, -217.59999999999985, -240.80000000000024, -252.9999999999999, -271.60000000000036, -240.9000000000003, -226.80000000000018, -231.80000000000015, -229.10000000000005, -212.2, -246.3000000000001, -222.70000000000013, -185.1000000000002, -204.50000000000006, -198.20000000000027, -182.50000000000023], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.091135122535202, "mean_inference_ms": 2.025623103589279, "mean_action_processing_ms": 0.17274569168000886, "mean_env_wait_ms": 19.671268523005594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -136.10000000000002, "episode_reward_min": -417.1999999999997, "episode_reward_mean": -217.33900000000006, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-192.80000000000013, -270.6000000000004, -275.99999999999983, -244.2000000000003, -214.00000000000037, -177.80000000000018, -181.69999999999987, -239.49999999999997, -262.79999999999967, -178.10000000000008, -222.60000000000036, -211.8999999999998, -213.29999999999976, -248.90000000000026, -201.10000000000022, -147.69999999999993, -183.09999999999997, -217.70000000000022, -216.10000000000008, -231.40000000000015, -219.30000000000047, -254.69999999999976, -201.70000000000002, -166.70000000000027, -191.2000000000001, -217.3999999999997, -208.30000000000044, -259.70000000000005, -215.5000000000002, -202.60000000000008, -219.69999999999987, -207.00000000000017, -276.60000000000014, -204.90000000000015, -218.70000000000041, -159.79999999999993, -212.7000000000005, -183.19999999999968, -214.99999999999983, -201.40000000000018, -215.70000000000027, -205.50000000000034, -245.99999999999997, -201.5, -213.9000000000003, -186.50000000000003, -245.69999999999987, -248.80000000000013, -210.10000000000016, -211.49999999999977, -314.5999999999996, -213.7999999999998, -212.7999999999999, -232.89999999999958, -253.40000000000026, -262.7000000000004, -188.79999999999978, -233.70000000000044, -213.19999999999985, -417.1999999999997, -238.09999999999988, -194.00000000000017, -193.89999999999986, -136.10000000000002, -227.9999999999997, -201.90000000000018, -216.1000000000002, -201.49999999999983, -183.70000000000002, -165.69999999999968, -228.7999999999997, -182.40000000000023, -247.60000000000025, -240.4000000000001, -224.60000000000005, -194.20000000000027, -222.00000000000026, -194.59999999999974, -185.60000000000025, -194.40000000000018, -241.79999999999973, -196.5000000000002, -184.50000000000023, -189.49999999999994, -189.20000000000024, -217.59999999999985, -240.80000000000024, -252.9999999999999, -271.60000000000036, -240.9000000000003, -226.80000000000018, -231.80000000000015, -229.10000000000005, -212.2, -246.3000000000001, -222.70000000000013, -185.1000000000002, -204.50000000000006, -198.20000000000027, -182.50000000000023], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.091135122535202, "mean_inference_ms": 2.025623103589279, "mean_action_processing_ms": 0.17274569168000886, "mean_env_wait_ms": 19.671268523005594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 17335.926, "load_time_ms": 10.88, "load_throughput": 367642.447, "learn_time_ms": 3411.328, "learn_throughput": 1172.564, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-58-01", "timestamp": 1678550281, "time_this_iter_s": 10.580497980117798, "time_total_s": 320.0426559448242, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183ae680>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a185319c0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 320.0426559448242, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 46.326666666666675, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.62365027166182, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 5.000000000000001e-05, "total_loss": 9.841718815219018, "policy_loss": -0.0012810260733409273, "vf_loss": 9.847528894485967, "vf_explained_var": -0.00016325942931636687, "kl": 0.003883930928839011, "entropy": 4.529106903076172, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": -136.10000000000002, "episode_reward_min": -417.1999999999997, "episode_reward_mean": -218.00000000000009, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.10000000000016, -211.49999999999977, -314.5999999999996, -213.7999999999998, -212.7999999999999, -232.89999999999958, -253.40000000000026, -262.7000000000004, -188.79999999999978, -233.70000000000044, -213.19999999999985, -417.1999999999997, -238.09999999999988, -194.00000000000017, -193.89999999999986, -136.10000000000002, -227.9999999999997, -201.90000000000018, -216.1000000000002, -201.49999999999983, -183.70000000000002, -165.69999999999968, -228.7999999999997, -182.40000000000023, -247.60000000000025, -240.4000000000001, -224.60000000000005, -194.20000000000027, -222.00000000000026, -194.59999999999974, -185.60000000000025, -194.40000000000018, -241.79999999999973, -196.5000000000002, -184.50000000000023, -189.49999999999994, -189.20000000000024, -217.59999999999985, -240.80000000000024, -252.9999999999999, -271.60000000000036, -240.9000000000003, -226.80000000000018, -231.80000000000015, -229.10000000000005, -212.2, -246.3000000000001, -222.70000000000013, -185.1000000000002, -204.50000000000006, -198.20000000000027, -182.50000000000023, -273.5999999999999, -206.69999999999956, -234.20000000000033, -199.50000000000026, -212.50000000000028, -206.3000000000003, -179.2000000000002, -214.00000000000009, -219.4999999999999, -207.6000000000001, -177.09999999999994, -189.5000000000003, -259.70000000000005, -199.80000000000004, -234.70000000000027, -183.10000000000045, -216.59999999999974, -187.00000000000006, -243.69999999999996, -184.0000000000002, -177.30000000000004, -202.50000000000028, -240.40000000000032, -223.29999999999967, -255.7000000000004, -226.30000000000004, -179.10000000000036, -211.20000000000002, -255.4999999999999, -356.3999999999991, -211.6000000000002, -162.00000000000014, -158.4000000000002, -190.1000000000002, -206.40000000000023, -200.40000000000023, -236.89999999999984, -199.7000000000003, -252.79999999999976, -246.50000000000006, -263.0999999999997, -193.49999999999994, -259.4000000000004, -240.0999999999998, -237.39999999999964, -169.20000000000022, -206.39999999999992, -207.2000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.093041698879769, "mean_inference_ms": 2.021823529374518, "mean_action_processing_ms": 0.1723764429164212, "mean_env_wait_ms": 19.64773451361572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -136.10000000000002, "episode_reward_min": -417.1999999999997, "episode_reward_mean": -218.00000000000009, "episode_len_mean": 99.0, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-210.10000000000016, -211.49999999999977, -314.5999999999996, -213.7999999999998, -212.7999999999999, -232.89999999999958, -253.40000000000026, -262.7000000000004, -188.79999999999978, -233.70000000000044, -213.19999999999985, -417.1999999999997, -238.09999999999988, -194.00000000000017, -193.89999999999986, -136.10000000000002, -227.9999999999997, -201.90000000000018, -216.1000000000002, -201.49999999999983, -183.70000000000002, -165.69999999999968, -228.7999999999997, -182.40000000000023, -247.60000000000025, -240.4000000000001, -224.60000000000005, -194.20000000000027, -222.00000000000026, -194.59999999999974, -185.60000000000025, -194.40000000000018, -241.79999999999973, -196.5000000000002, -184.50000000000023, -189.49999999999994, -189.20000000000024, -217.59999999999985, -240.80000000000024, -252.9999999999999, -271.60000000000036, -240.9000000000003, -226.80000000000018, -231.80000000000015, -229.10000000000005, -212.2, -246.3000000000001, -222.70000000000013, -185.1000000000002, -204.50000000000006, -198.20000000000027, -182.50000000000023, -273.5999999999999, -206.69999999999956, -234.20000000000033, -199.50000000000026, -212.50000000000028, -206.3000000000003, -179.2000000000002, -214.00000000000009, -219.4999999999999, -207.6000000000001, -177.09999999999994, -189.5000000000003, -259.70000000000005, -199.80000000000004, -234.70000000000027, -183.10000000000045, -216.59999999999974, -187.00000000000006, -243.69999999999996, -184.0000000000002, -177.30000000000004, -202.50000000000028, -240.40000000000032, -223.29999999999967, -255.7000000000004, -226.30000000000004, -179.10000000000036, -211.20000000000002, -255.4999999999999, -356.3999999999991, -211.6000000000002, -162.00000000000014, -158.4000000000002, -190.1000000000002, -206.40000000000023, -200.40000000000023, -236.89999999999984, -199.7000000000003, -252.79999999999976, -246.50000000000006, -263.0999999999997, -193.49999999999994, -259.4000000000004, -240.0999999999998, -237.39999999999964, -169.20000000000022, -206.39999999999992, -207.2000000000002], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.093041698879769, "mean_inference_ms": 2.021823529374518, "mean_action_processing_ms": 0.1723764429164212, "mean_env_wait_ms": 19.64773451361572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 17245.594, "load_time_ms": 10.758, "load_throughput": 371800.028, "learn_time_ms": 3424.074, "learn_throughput": 1168.199, "synch_weights_time_ms": 2.191}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 808, "training_iteration": 20, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-58-27", "timestamp": 1678550307, "time_this_iter_s": 26.407702207565308, "time_total_s": 346.4503581523895, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c7100>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c6230>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 346.4503581523895, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 97.12894736842105, "ram_util_percent": 21.960526315789473}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6826948668687575, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 5.000000000000001e-05, "total_loss": 9.44731932609312, "policy_loss": -0.0003107226498785519, "vf_loss": 9.45214637325656, "vf_explained_var": 2.172416256320092e-05, "kl": 0.002823034152910897, "entropy": 4.516321622171709, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": -154.29999999999998, "episode_reward_min": -356.3999999999991, "episode_reward_mean": -216.04700000000008, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-271.60000000000036, -240.9000000000003, -226.80000000000018, -231.80000000000015, -229.10000000000005, -212.2, -246.3000000000001, -222.70000000000013, -185.1000000000002, -204.50000000000006, -198.20000000000027, -182.50000000000023, -273.5999999999999, -206.69999999999956, -234.20000000000033, -199.50000000000026, -212.50000000000028, -206.3000000000003, -179.2000000000002, -214.00000000000009, -219.4999999999999, -207.6000000000001, -177.09999999999994, -189.5000000000003, -259.70000000000005, -199.80000000000004, -234.70000000000027, -183.10000000000045, -216.59999999999974, -187.00000000000006, -243.69999999999996, -184.0000000000002, -177.30000000000004, -202.50000000000028, -240.40000000000032, -223.29999999999967, -255.7000000000004, -226.30000000000004, -179.10000000000036, -211.20000000000002, -255.4999999999999, -356.3999999999991, -211.6000000000002, -162.00000000000014, -158.4000000000002, -190.1000000000002, -206.40000000000023, -200.40000000000023, -236.89999999999984, -199.7000000000003, -252.79999999999976, -246.50000000000006, -263.0999999999997, -193.49999999999994, -259.4000000000004, -240.0999999999998, -237.39999999999964, -169.20000000000022, -206.39999999999992, -207.2000000000002, -171.10000000000045, -230.8000000000001, -183.6000000000001, -237.60000000000034, -193.8, -186.50000000000006, -230.70000000000002, -169.40000000000023, -160.30000000000004, -276.40000000000003, -186.19999999999948, -173.00000000000034, -223.40000000000012, -198.4000000000002, -206.7999999999998, -202.90000000000015, -239.70000000000047, -230.89999999999986, -211.30000000000007, -229.99999999999991, -249.5000000000002, -203.80000000000038, -225.80000000000038, -201.6000000000001, -255.6000000000001, -232.5, -245.59999999999994, -198.50000000000028, -240.40000000000023, -154.29999999999998, -234.20000000000013, -240.50000000000028, -224.0999999999997, -256.19999999999993, -208.19999999999996, -203.00000000000017, -209.40000000000035, -239.3000000000002, -195.30000000000027, -195.30000000000044], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.142360680965667, "mean_inference_ms": 2.050985074220153, "mean_action_processing_ms": 0.17454002300470087, "mean_env_wait_ms": 19.926526853087022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -154.29999999999998, "episode_reward_min": -356.3999999999991, "episode_reward_mean": -216.04700000000008, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-271.60000000000036, -240.9000000000003, -226.80000000000018, -231.80000000000015, -229.10000000000005, -212.2, -246.3000000000001, -222.70000000000013, -185.1000000000002, -204.50000000000006, -198.20000000000027, -182.50000000000023, -273.5999999999999, -206.69999999999956, -234.20000000000033, -199.50000000000026, -212.50000000000028, -206.3000000000003, -179.2000000000002, -214.00000000000009, -219.4999999999999, -207.6000000000001, -177.09999999999994, -189.5000000000003, -259.70000000000005, -199.80000000000004, -234.70000000000027, -183.10000000000045, -216.59999999999974, -187.00000000000006, -243.69999999999996, -184.0000000000002, -177.30000000000004, -202.50000000000028, -240.40000000000032, -223.29999999999967, -255.7000000000004, -226.30000000000004, -179.10000000000036, -211.20000000000002, -255.4999999999999, -356.3999999999991, -211.6000000000002, -162.00000000000014, -158.4000000000002, -190.1000000000002, -206.40000000000023, -200.40000000000023, -236.89999999999984, -199.7000000000003, -252.79999999999976, -246.50000000000006, -263.0999999999997, -193.49999999999994, -259.4000000000004, -240.0999999999998, -237.39999999999964, -169.20000000000022, -206.39999999999992, -207.2000000000002, -171.10000000000045, -230.8000000000001, -183.6000000000001, -237.60000000000034, -193.8, -186.50000000000006, -230.70000000000002, -169.40000000000023, -160.30000000000004, -276.40000000000003, -186.19999999999948, -173.00000000000034, -223.40000000000012, -198.4000000000002, -206.7999999999998, -202.90000000000015, -239.70000000000047, -230.89999999999986, -211.30000000000007, -229.99999999999991, -249.5000000000002, -203.80000000000038, -225.80000000000038, -201.6000000000001, -255.6000000000001, -232.5, -245.59999999999994, -198.50000000000028, -240.40000000000023, -154.29999999999998, -234.20000000000013, -240.50000000000028, -224.0999999999997, -256.19999999999993, -208.19999999999996, -203.00000000000017, -209.40000000000035, -239.3000000000002, -195.30000000000027, -195.30000000000044], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.142360680965667, "mean_inference_ms": 2.050985074220153, "mean_action_processing_ms": 0.17454002300470087, "mean_env_wait_ms": 19.926526853087022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 17831.323, "load_time_ms": 10.793, "load_throughput": 370618.138, "learn_time_ms": 3418.675, "learn_throughput": 1170.044, "synch_weights_time_ms": 2.181}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 848, "training_iteration": 21, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-58-47", "timestamp": 1678550327, "time_this_iter_s": 19.4097740650177, "time_total_s": 365.8601322174072, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a185310c0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18533e80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 365.8601322174072, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 81.39285714285714, "ram_util_percent": 20.035714285714285}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1726983668342714, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 5.000000000000001e-05, "total_loss": 9.044488603838028, "policy_loss": -0.003316251415338728, "vf_loss": 9.052299502588088, "vf_explained_var": 5.373262589977633e-06, "kl": 0.0034757006010918694, "entropy": 4.494672478398969, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": -146.49999999999974, "episode_reward_min": -366.39999999999935, "episode_reward_mean": -214.94400000000007, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-255.4999999999999, -356.3999999999991, -211.6000000000002, -162.00000000000014, -158.4000000000002, -190.1000000000002, -206.40000000000023, -200.40000000000023, -236.89999999999984, -199.7000000000003, -252.79999999999976, -246.50000000000006, -263.0999999999997, -193.49999999999994, -259.4000000000004, -240.0999999999998, -237.39999999999964, -169.20000000000022, -206.39999999999992, -207.2000000000002, -171.10000000000045, -230.8000000000001, -183.6000000000001, -237.60000000000034, -193.8, -186.50000000000006, -230.70000000000002, -169.40000000000023, -160.30000000000004, -276.40000000000003, -186.19999999999948, -173.00000000000034, -223.40000000000012, -198.4000000000002, -206.7999999999998, -202.90000000000015, -239.70000000000047, -230.89999999999986, -211.30000000000007, -229.99999999999991, -249.5000000000002, -203.80000000000038, -225.80000000000038, -201.6000000000001, -255.6000000000001, -232.5, -245.59999999999994, -198.50000000000028, -240.40000000000023, -154.29999999999998, -234.20000000000013, -240.50000000000028, -224.0999999999997, -256.19999999999993, -208.19999999999996, -203.00000000000017, -209.40000000000035, -239.3000000000002, -195.30000000000027, -195.30000000000044, -257.4, -217.2000000000002, -179.20000000000022, -290.89999999999975, -238.70000000000041, -171.50000000000028, -198.90000000000018, -192.49999999999974, -223.5999999999999, -183.19999999999987, -199.3, -187.20000000000027, -194.70000000000007, -208.4000000000001, -366.39999999999935, -211.50000000000006, -212.00000000000006, -282.4, -168.80000000000027, -196.90000000000018, -238.6999999999999, -181.5999999999999, -257.2000000000001, -190.80000000000007, -170.8000000000001, -146.49999999999974, -163.90000000000023, -216.30000000000007, -195.29999999999973, -202.4000000000003, -239.60000000000005, -215.89999999999992, -204.50000000000037, -172.39999999999998, -188.60000000000014, -212.29999999999959, -245.7999999999997, -235.50000000000028, -188.50000000000003, -238.19999999999965], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.134804835730346, "mean_inference_ms": 2.052928309274067, "mean_action_processing_ms": 0.17490544534537086, "mean_env_wait_ms": 19.946342381469073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -146.49999999999974, "episode_reward_min": -366.39999999999935, "episode_reward_mean": -214.94400000000007, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-255.4999999999999, -356.3999999999991, -211.6000000000002, -162.00000000000014, -158.4000000000002, -190.1000000000002, -206.40000000000023, -200.40000000000023, -236.89999999999984, -199.7000000000003, -252.79999999999976, -246.50000000000006, -263.0999999999997, -193.49999999999994, -259.4000000000004, -240.0999999999998, -237.39999999999964, -169.20000000000022, -206.39999999999992, -207.2000000000002, -171.10000000000045, -230.8000000000001, -183.6000000000001, -237.60000000000034, -193.8, -186.50000000000006, -230.70000000000002, -169.40000000000023, -160.30000000000004, -276.40000000000003, -186.19999999999948, -173.00000000000034, -223.40000000000012, -198.4000000000002, -206.7999999999998, -202.90000000000015, -239.70000000000047, -230.89999999999986, -211.30000000000007, -229.99999999999991, -249.5000000000002, -203.80000000000038, -225.80000000000038, -201.6000000000001, -255.6000000000001, -232.5, -245.59999999999994, -198.50000000000028, -240.40000000000023, -154.29999999999998, -234.20000000000013, -240.50000000000028, -224.0999999999997, -256.19999999999993, -208.19999999999996, -203.00000000000017, -209.40000000000035, -239.3000000000002, -195.30000000000027, -195.30000000000044, -257.4, -217.2000000000002, -179.20000000000022, -290.89999999999975, -238.70000000000041, -171.50000000000028, -198.90000000000018, -192.49999999999974, -223.5999999999999, -183.19999999999987, -199.3, -187.20000000000027, -194.70000000000007, -208.4000000000001, -366.39999999999935, -211.50000000000006, -212.00000000000006, -282.4, -168.80000000000027, -196.90000000000018, -238.6999999999999, -181.5999999999999, -257.2000000000001, -190.80000000000007, -170.8000000000001, -146.49999999999974, -163.90000000000023, -216.30000000000007, -195.29999999999973, -202.4000000000003, -239.60000000000005, -215.89999999999992, -204.50000000000037, -172.39999999999998, -188.60000000000014, -212.29999999999959, -245.7999999999997, -235.50000000000028, -188.50000000000003, -238.19999999999965], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.134804835730346, "mean_inference_ms": 2.052928309274067, "mean_action_processing_ms": 0.17490544534537086, "mean_env_wait_ms": 19.946342381469073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 17830.788, "load_time_ms": 10.841, "load_throughput": 368981.416, "learn_time_ms": 3415.552, "learn_throughput": 1171.114, "synch_weights_time_ms": 2.177}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 888, "training_iteration": 22, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-58-57", "timestamp": 1678550337, "time_this_iter_s": 10.543257713317871, "time_total_s": 376.4033899307251, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183c4d90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183aed40>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 376.4033899307251, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 45.71333333333333, "ram_util_percent": 16.5}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7545914300026433, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 5.000000000000001e-05, "total_loss": 9.007549999606224, "policy_loss": -0.0032010201259606305, "vf_loss": 9.015243238018405, "vf_explained_var": 2.591648409443517e-06, "kl": 0.0041527876093066214, "entropy": 4.4922057628631595, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": -146.49999999999974, "episode_reward_min": -366.39999999999935, "episode_reward_mean": -213.88500000000008, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-249.5000000000002, -203.80000000000038, -225.80000000000038, -201.6000000000001, -255.6000000000001, -232.5, -245.59999999999994, -198.50000000000028, -240.40000000000023, -154.29999999999998, -234.20000000000013, -240.50000000000028, -224.0999999999997, -256.19999999999993, -208.19999999999996, -203.00000000000017, -209.40000000000035, -239.3000000000002, -195.30000000000027, -195.30000000000044, -257.4, -217.2000000000002, -179.20000000000022, -290.89999999999975, -238.70000000000041, -171.50000000000028, -198.90000000000018, -192.49999999999974, -223.5999999999999, -183.19999999999987, -199.3, -187.20000000000027, -194.70000000000007, -208.4000000000001, -366.39999999999935, -211.50000000000006, -212.00000000000006, -282.4, -168.80000000000027, -196.90000000000018, -238.6999999999999, -181.5999999999999, -257.2000000000001, -190.80000000000007, -170.8000000000001, -146.49999999999974, -163.90000000000023, -216.30000000000007, -195.29999999999973, -202.4000000000003, -239.60000000000005, -215.89999999999992, -204.50000000000037, -172.39999999999998, -188.60000000000014, -212.29999999999959, -245.7999999999997, -235.50000000000028, -188.50000000000003, -238.19999999999965, -266.40000000000026, -196.50000000000023, -194.99999999999997, -204.1999999999999, -206.7999999999999, -177.7000000000004, -268.9000000000001, -222.10000000000014, -230.40000000000035, -185.50000000000026, -214.70000000000036, -193.80000000000004, -235.60000000000045, -213.1000000000002, -190.59999999999982, -215.89999999999975, -213.9000000000003, -185.00000000000003, -213.70000000000005, -245.90000000000026, -198.60000000000028, -223.60000000000016, -197.89999999999984, -244.4000000000004, -228.50000000000014, -183.4000000000002, -216.39999999999995, -224.30000000000018, -210.9999999999997, -200.0, -237.00000000000009, -192.40000000000003, -215.89999999999998, -188.3999999999997, -173.59999999999988, -226.6999999999998, -239.80000000000018, -215.3000000000001, -228.20000000000007, -168.8000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.115217667308777, "mean_inference_ms": 2.0494407323781814, "mean_action_processing_ms": 0.17439024924815436, "mean_env_wait_ms": 19.915939334317198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -146.49999999999974, "episode_reward_min": -366.39999999999935, "episode_reward_mean": -213.88500000000008, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-249.5000000000002, -203.80000000000038, -225.80000000000038, -201.6000000000001, -255.6000000000001, -232.5, -245.59999999999994, -198.50000000000028, -240.40000000000023, -154.29999999999998, -234.20000000000013, -240.50000000000028, -224.0999999999997, -256.19999999999993, -208.19999999999996, -203.00000000000017, -209.40000000000035, -239.3000000000002, -195.30000000000027, -195.30000000000044, -257.4, -217.2000000000002, -179.20000000000022, -290.89999999999975, -238.70000000000041, -171.50000000000028, -198.90000000000018, -192.49999999999974, -223.5999999999999, -183.19999999999987, -199.3, -187.20000000000027, -194.70000000000007, -208.4000000000001, -366.39999999999935, -211.50000000000006, -212.00000000000006, -282.4, -168.80000000000027, -196.90000000000018, -238.6999999999999, -181.5999999999999, -257.2000000000001, -190.80000000000007, -170.8000000000001, -146.49999999999974, -163.90000000000023, -216.30000000000007, -195.29999999999973, -202.4000000000003, -239.60000000000005, -215.89999999999992, -204.50000000000037, -172.39999999999998, -188.60000000000014, -212.29999999999959, -245.7999999999997, -235.50000000000028, -188.50000000000003, -238.19999999999965, -266.40000000000026, -196.50000000000023, -194.99999999999997, -204.1999999999999, -206.7999999999999, -177.7000000000004, -268.9000000000001, -222.10000000000014, -230.40000000000035, -185.50000000000026, -214.70000000000036, -193.80000000000004, -235.60000000000045, -213.1000000000002, -190.59999999999982, -215.89999999999975, -213.9000000000003, -185.00000000000003, -213.70000000000005, -245.90000000000026, -198.60000000000028, -223.60000000000016, -197.89999999999984, -244.4000000000004, -228.50000000000014, -183.4000000000002, -216.39999999999995, -224.30000000000018, -210.9999999999997, -200.0, -237.00000000000009, -192.40000000000003, -215.89999999999998, -188.3999999999997, -173.59999999999988, -226.6999999999998, -239.80000000000018, -215.3000000000001, -228.20000000000007, -168.8000000000003], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.115217667308777, "mean_inference_ms": 2.0494407323781814, "mean_action_processing_ms": 0.17439024924815436, "mean_env_wait_ms": 19.915939334317198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 17523.152, "load_time_ms": 10.427, "load_throughput": 383622.15, "learn_time_ms": 3363.523, "learn_throughput": 1189.229, "synch_weights_time_ms": 2.149}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 928, "training_iteration": 23, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-59-18", "timestamp": 1678550358, "time_this_iter_s": 20.657360792160034, "time_total_s": 397.06075072288513, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183d00a0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183d0700>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 397.06075072288513, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 91.89655172413794, "ram_util_percent": 19.93103448275862}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2851051089263732, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 5.000000000000001e-05, "total_loss": 9.604049285765617, "policy_loss": -0.0057387699913834375, "vf_loss": 9.61430691442182, "vf_explained_var": 1.3584090817359185e-06, "kl": 0.0038626215228875454, "entropy": 4.51881593273532, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": -122.70000000000016, "episode_reward_min": -400.6999999999996, "episode_reward_mean": -211.5070000000001, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-238.6999999999999, -181.5999999999999, -257.2000000000001, -190.80000000000007, -170.8000000000001, -146.49999999999974, -163.90000000000023, -216.30000000000007, -195.29999999999973, -202.4000000000003, -239.60000000000005, -215.89999999999992, -204.50000000000037, -172.39999999999998, -188.60000000000014, -212.29999999999959, -245.7999999999997, -235.50000000000028, -188.50000000000003, -238.19999999999965, -266.40000000000026, -196.50000000000023, -194.99999999999997, -204.1999999999999, -206.7999999999999, -177.7000000000004, -268.9000000000001, -222.10000000000014, -230.40000000000035, -185.50000000000026, -214.70000000000036, -193.80000000000004, -235.60000000000045, -213.1000000000002, -190.59999999999982, -215.89999999999975, -213.9000000000003, -185.00000000000003, -213.70000000000005, -245.90000000000026, -198.60000000000028, -223.60000000000016, -197.89999999999984, -244.4000000000004, -228.50000000000014, -183.4000000000002, -216.39999999999995, -224.30000000000018, -210.9999999999997, -200.0, -237.00000000000009, -192.40000000000003, -215.89999999999998, -188.3999999999997, -173.59999999999988, -226.6999999999998, -239.80000000000018, -215.3000000000001, -228.20000000000007, -168.8000000000003, -207.10000000000002, -181.80000000000004, -184.90000000000032, -214.89999999999995, -203.69999999999968, -257.8000000000005, -193.4000000000004, -181.10000000000048, -201.5000000000002, -214.90000000000032, -122.70000000000016, -186.8000000000001, -217.70000000000027, -300.09999999999997, -139.60000000000016, -225.00000000000048, -181.1999999999999, -235.4000000000003, -164.30000000000004, -221.49999999999983, -189.50000000000014, -266.9000000000001, -229.5999999999998, -163.4000000000002, -164.70000000000016, -210.90000000000012, -227.8000000000003, -400.6999999999996, -233.10000000000028, -242.90000000000012, -202.29999999999984, -232.2000000000002, -260.30000000000007, -245.80000000000027, -243.29999999999984, -255.80000000000018, -231.20000000000044, -173.8000000000002, -163.3999999999998, -182.99999999999977], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.151789389164282, "mean_inference_ms": 2.0675619786623387, "mean_action_processing_ms": 0.17588665428184974, "mean_env_wait_ms": 20.099850920275557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -122.70000000000016, "episode_reward_min": -400.6999999999996, "episode_reward_mean": -211.5070000000001, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-238.6999999999999, -181.5999999999999, -257.2000000000001, -190.80000000000007, -170.8000000000001, -146.49999999999974, -163.90000000000023, -216.30000000000007, -195.29999999999973, -202.4000000000003, -239.60000000000005, -215.89999999999992, -204.50000000000037, -172.39999999999998, -188.60000000000014, -212.29999999999959, -245.7999999999997, -235.50000000000028, -188.50000000000003, -238.19999999999965, -266.40000000000026, -196.50000000000023, -194.99999999999997, -204.1999999999999, -206.7999999999999, -177.7000000000004, -268.9000000000001, -222.10000000000014, -230.40000000000035, -185.50000000000026, -214.70000000000036, -193.80000000000004, -235.60000000000045, -213.1000000000002, -190.59999999999982, -215.89999999999975, -213.9000000000003, -185.00000000000003, -213.70000000000005, -245.90000000000026, -198.60000000000028, -223.60000000000016, -197.89999999999984, -244.4000000000004, -228.50000000000014, -183.4000000000002, -216.39999999999995, -224.30000000000018, -210.9999999999997, -200.0, -237.00000000000009, -192.40000000000003, -215.89999999999998, -188.3999999999997, -173.59999999999988, -226.6999999999998, -239.80000000000018, -215.3000000000001, -228.20000000000007, -168.8000000000003, -207.10000000000002, -181.80000000000004, -184.90000000000032, -214.89999999999995, -203.69999999999968, -257.8000000000005, -193.4000000000004, -181.10000000000048, -201.5000000000002, -214.90000000000032, -122.70000000000016, -186.8000000000001, -217.70000000000027, -300.09999999999997, -139.60000000000016, -225.00000000000048, -181.1999999999999, -235.4000000000003, -164.30000000000004, -221.49999999999983, -189.50000000000014, -266.9000000000001, -229.5999999999998, -163.4000000000002, -164.70000000000016, -210.90000000000012, -227.8000000000003, -400.6999999999996, -233.10000000000028, -242.90000000000012, -202.29999999999984, -232.2000000000002, -260.30000000000007, -245.80000000000027, -243.29999999999984, -255.80000000000018, -231.20000000000044, -173.8000000000002, -163.3999999999998, -182.99999999999977], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.151789389164282, "mean_inference_ms": 2.0675619786623387, "mean_action_processing_ms": 0.17588665428184974, "mean_env_wait_ms": 20.099850920275557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 17752.088, "load_time_ms": 11.674, "load_throughput": 342629.207, "learn_time_ms": 3380.707, "learn_throughput": 1183.185, "synch_weights_time_ms": 2.132}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 968, "training_iteration": 24, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-59-43", "timestamp": 1678550383, "time_this_iter_s": 24.26939368247986, "time_total_s": 421.330144405365, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a185339d0>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a18530a90>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 421.330144405365, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 93.00571428571428, "ram_util_percent": 22.69142857142857}}
{"custom_metrics": {}, "episode_media": {}, "num_recreated_workers": 0, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7834885546276646, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 5.000000000000001e-05, "total_loss": 9.645434179613668, "policy_loss": -0.005743847168501346, "vf_loss": 9.655656731513238, "vf_explained_var": 1.0448117409982988e-06, "kl": 0.002805349447724059, "entropy": 4.478635021948045, "entropy_coeff": 0.0010000000000000002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": -119.89999999999985, "episode_reward_min": -712.3000000000014, "episode_reward_mean": -212.17700000000008, "episode_len_mean": 99.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-198.60000000000028, -223.60000000000016, -197.89999999999984, -244.4000000000004, -228.50000000000014, -183.4000000000002, -216.39999999999995, -224.30000000000018, -210.9999999999997, -200.0, -237.00000000000009, -192.40000000000003, -215.89999999999998, -188.3999999999997, -173.59999999999988, -226.6999999999998, -239.80000000000018, -215.3000000000001, -228.20000000000007, -168.8000000000003, -207.10000000000002, -181.80000000000004, -184.90000000000032, -214.89999999999995, -203.69999999999968, -257.8000000000005, -193.4000000000004, -181.10000000000048, -201.5000000000002, -214.90000000000032, -122.70000000000016, -186.8000000000001, -217.70000000000027, -300.09999999999997, -139.60000000000016, -225.00000000000048, -181.1999999999999, -235.4000000000003, -164.30000000000004, -221.49999999999983, -189.50000000000014, -266.9000000000001, -229.5999999999998, -163.4000000000002, -164.70000000000016, -210.90000000000012, -227.8000000000003, -400.6999999999996, -233.10000000000028, -242.90000000000012, -202.29999999999984, -232.2000000000002, -260.30000000000007, -245.80000000000027, -243.29999999999984, -255.80000000000018, -231.20000000000044, -173.8000000000002, -163.3999999999998, -182.99999999999977, -196.6000000000002, -181.30000000000018, -184.7999999999999, -245.0999999999998, -156.90000000000003, -220.59999999999997, -199.7000000000001, -214.3000000000003, -236.7000000000004, -168.59999999999982, -197.80000000000035, -119.89999999999985, -194.20000000000007, -195.7, -213.80000000000038, -192.69999999999993, -140.79999999999995, -165.70000000000033, -134.80000000000004, -219.4, -282.3000000000005, -182.20000000000027, -149.09999999999982, -192.70000000000022, -212.7000000000003, -186.90000000000032, -153.89999999999984, -446.0000000000007, -177.99999999999977, -205.80000000000032, -205.7999999999999, -203.80000000000032, -712.3000000000014, -153.3000000000002, -215.60000000000042, -191.40000000000012, -215.69999999999996, -196.19999999999985, -175.10000000000022, -209.3000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.174608864748746, "mean_inference_ms": 2.0753883334987053, "mean_action_processing_ms": 0.17645055655485706, "mean_env_wait_ms": 20.179018574929334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0}, "episode_reward_max": -119.89999999999985, "episode_reward_min": -712.3000000000014, "episode_reward_mean": -212.17700000000008, "episode_len_mean": 99.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-198.60000000000028, -223.60000000000016, -197.89999999999984, -244.4000000000004, -228.50000000000014, -183.4000000000002, -216.39999999999995, -224.30000000000018, -210.9999999999997, -200.0, -237.00000000000009, -192.40000000000003, -215.89999999999998, -188.3999999999997, -173.59999999999988, -226.6999999999998, -239.80000000000018, -215.3000000000001, -228.20000000000007, -168.8000000000003, -207.10000000000002, -181.80000000000004, -184.90000000000032, -214.89999999999995, -203.69999999999968, -257.8000000000005, -193.4000000000004, -181.10000000000048, -201.5000000000002, -214.90000000000032, -122.70000000000016, -186.8000000000001, -217.70000000000027, -300.09999999999997, -139.60000000000016, -225.00000000000048, -181.1999999999999, -235.4000000000003, -164.30000000000004, -221.49999999999983, -189.50000000000014, -266.9000000000001, -229.5999999999998, -163.4000000000002, -164.70000000000016, -210.90000000000012, -227.8000000000003, -400.6999999999996, -233.10000000000028, -242.90000000000012, -202.29999999999984, -232.2000000000002, -260.30000000000007, -245.80000000000027, -243.29999999999984, -255.80000000000018, -231.20000000000044, -173.8000000000002, -163.3999999999998, -182.99999999999977, -196.6000000000002, -181.30000000000018, -184.7999999999999, -245.0999999999998, -156.90000000000003, -220.59999999999997, -199.7000000000001, -214.3000000000003, -236.7000000000004, -168.59999999999982, -197.80000000000035, -119.89999999999985, -194.20000000000007, -195.7, -213.80000000000038, -192.69999999999993, -140.79999999999995, -165.70000000000033, -134.80000000000004, -219.4, -282.3000000000005, -182.20000000000027, -149.09999999999982, -192.70000000000022, -212.7000000000003, -186.90000000000032, -153.89999999999984, -446.0000000000007, -177.99999999999977, -205.80000000000032, -205.7999999999999, -203.80000000000032, -712.3000000000014, -153.3000000000002, -215.60000000000042, -191.40000000000012, -215.69999999999996, -196.19999999999985, -175.10000000000022, -209.3000000000001], "episode_lengths": [99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.174608864748746, "mean_inference_ms": 2.0753883334987053, "mean_action_processing_ms": 0.17645055655485706, "mean_env_wait_ms": 20.179018574929334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "num_healthy_workers": 2, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 17770.912, "load_time_ms": 11.7, "load_throughput": 341891.188, "learn_time_ms": 3400.196, "learn_throughput": 1176.403, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1008, "training_iteration": 25, "trial_id": "bb8d1_00000", "experiment_id": "9eb5f2dab0794366aa66ad3b78f001e9", "date": "2023-03-11_15-59-53", "timestamp": 1678550393, "time_this_iter_s": 10.718708515167236, "time_total_s": 432.0488529205322, "pid": 16120, "hostname": "krystals-rl-gpu-vm", "node_ip": "10.142.15.247", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'CybORGAgent.CybORGAgent'>", "env_config": {"null": 0}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "num_workers": 2, "num_envs_per_worker": 4, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": false, "rollout_fragment_length": 100, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": false, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "horizon": 100, "soft_horizon": false, "no_done_at_end": false, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "train_batch_size": 4000, "model": {"_use_default_native_models": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256, 52], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 10, "lstm_cell_size": 256, "lstm_use_prev_action": true, "lstm_use_prev_reward": true, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_Torch", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": {}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183d0a30>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "off_policy_estimation_methods": {}, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "monitor": -1, "evaluation_num_episodes": -1, "metrics_smoothing_episodes": -1, "timesteps_per_iteration": -1, "min_iter_time_s": -1, "collect_metrics_timeout": -1, "buffer_size": -1, "prioritized_replay": -1, "learning_starts": -1, "replay_batch_size": -1, "replay_sequence_length": null, "prioritized_replay_alpha": -1, "prioritized_replay_beta": -1, "prioritized_replay_eps": -1, "min_time_s_per_reporting": -1, "min_train_timesteps_per_reporting": -1, "min_sample_timesteps_per_reporting": -1, "input_evaluation": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": "<ray.rllib.policy.policy.PolicySpec object at 0x7f7a183d0e80>"}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1}, "time_since_restore": 432.0488529205322, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 4.781639099121094, "perf": {"cpu_util_percent": 45.906666666666666, "ram_util_percent": 16.5}}
